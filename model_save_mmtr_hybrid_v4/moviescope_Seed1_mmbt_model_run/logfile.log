INFO - 09/07/21 23:24:53 - 0:00:00 - a_len: 3
                                     adapter_size: 64
                                     aonly: True
                                     attn_dropout: 0.1
                                     attn_dropout_a: 0.0
                                     attn_dropout_v: 0.0
                                     attn_mask: True
                                     batch_sz: 8
                                     bert_model: bert-base-uncased
                                     chunk_size: 100
                                     config_file: /home/est_posgrado_diego.moreno/vilbert-multi-task/config/bert_base_6layer_6conect.json
                                     data_path: /home/est_posgrado_diego.moreno/Workspace/Tesis/multimodal-transformers-movies/datasets
                                     drop_img_percent: 0.0
                                     dropout: 0.1
                                     embed_dropout: 0.25
                                     embed_sz: 300
                                     freeze_img: 0
                                     freeze_txt: 0
                                     from_pretrained: /home/est_posgrado_diego.moreno/vilbert-multi-task/save/multi_task_model.bin
                                     glove_path: /path/to/glove_embeds/glove.840B.300d.txt
                                     gradient_accumulation_steps: 16
                                     hidden: []
                                     hidden_sz: 768
                                     img_embed_pool_type: avg
                                     img_hidden_sz: 2048
                                     include_bn: True
                                     l_len: 512
                                     label_freqs: Counter({'Drama': 1803, 'Comedy': 1276, 'Thriller': 1010, 'Action': 825, 'Romance': 767, 'Fantasy': 665, 'Crime': 610, 'Sci-Fi': 424, 'Horror': 395, 'Family': 385, 'Mystery': 343, 'Biography': 207, 'Animation': 175})
                                     labels: ['Mystery', 'Thriller', 'Comedy', 'Action', 'Crime', 'Drama', 'Fantasy', 'Family', 'Horror', 'Biography', 'Romance', 'Sci-Fi', 'Animation']
                                     layers: 5
                                     lonly: True
                                     lr: 5e-05
                                     lr_factor: 0.5
                                     lr_patience: 2
                                     max_epochs: 100
                                     max_seq_len: 512
                                     model: mmtrvapt
                                     n_classes: 13
                                     n_workers: 12
                                     name: moviescope_Seed1_mmbt_model_run
                                     nlevels: 5
                                     num_heads: 6
                                     num_image_embeds: 3
                                     num_images: 8
                                     orig_d_a: 96
                                     orig_d_l: 768
                                     orig_d_m: 312
                                     orig_d_v: 4096
                                     out_dropout: 0.0
                                     output_gates: False
                                     patience: 5
                                     pooling: cls
                                     relu_dropout: 0.1
                                     res_dropout: 0.1
                                     savedir: /home/est_posgrado_diego.moreno/Workspace/Tesis/multimodal-transformers-movies/model_save_mmtr_hybrid_v4/moviescope_Seed1_mmbt_model_run
                                     seed: 1
                                     task: moviescope
                                     task_type: multilabel
                                     train_data_len: 3449
                                     train_type: split
                                     trained_model_dir: 
                                     v_len: 3
                                     vision_scratch: False
                                     visual: both
                                     vocab: <mmbt.data.vocab.Vocab object at 0x7fd59f038f10>
                                     vocab_sz: 30522
                                     vonly: True
                                     warmup: 0.1
                                     weight_classes: 1
INFO - 09/07/21 23:24:53 - 0:00:00 - DataParallel(
                                       (module): MMTransformerGMUHybridClf(
                                         (enc): BertEncoder(
                                           (bert): BertModel(
                                             (embeddings): BertEmbeddings(
                                               (word_embeddings): Embedding(30522, 768, padding_idx=0)
                                               (position_embeddings): Embedding(512, 768)
                                               (token_type_embeddings): Embedding(2, 768)
                                               (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
                                               (dropout): Dropout(p=0.1, inplace=False)
                                             )
                                             (encoder): BertEncoder(
                                               (layer): ModuleList(
                                                 (0): BertLayer(
                                                   (attention): BertAttention(
                                                     (self): BertSelfAttention(
                                                       (query): Linear(in_features=768, out_features=768, bias=True)
                                                       (key): Linear(in_features=768, out_features=768, bias=True)
                                                       (value): Linear(in_features=768, out_features=768, bias=True)
                                                       (dropout): Dropout(p=0.1, inplace=False)
                                                     )
                                                     (output): BertSelfOutput(
                                                       (dense): Linear(in_features=768, out_features=768, bias=True)
                                                       (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
                                                       (dropout): Dropout(p=0.1, inplace=False)
                                                       (attention_text_task_adapters): ModuleDict()
                                                       (adapter_fusion_layer): ModuleDict()
                                                       (attention_text_lang_adapters): ModuleDict()
                                                     )
                                                   )
                                                   (intermediate): BertIntermediate(
                                                     (dense): Linear(in_features=768, out_features=3072, bias=True)
                                                   )
                                                   (output): BertOutput(
                                                     (dense): Linear(in_features=3072, out_features=768, bias=True)
                                                     (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
                                                     (dropout): Dropout(p=0.1, inplace=False)
                                                     (adapter_fusion_layer): ModuleDict()
                                                     (layer_text_task_adapters): ModuleDict()
                                                     (layer_text_lang_adapters): ModuleDict()
                                                   )
                                                 )
                                                 (1): BertLayer(
                                                   (attention): BertAttention(
                                                     (self): BertSelfAttention(
                                                       (query): Linear(in_features=768, out_features=768, bias=True)
                                                       (key): Linear(in_features=768, out_features=768, bias=True)
                                                       (value): Linear(in_features=768, out_features=768, bias=True)
                                                       (dropout): Dropout(p=0.1, inplace=False)
                                                     )
                                                     (output): BertSelfOutput(
                                                       (dense): Linear(in_features=768, out_features=768, bias=True)
                                                       (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
                                                       (dropout): Dropout(p=0.1, inplace=False)
                                                       (attention_text_task_adapters): ModuleDict()
                                                       (adapter_fusion_layer): ModuleDict()
                                                       (attention_text_lang_adapters): ModuleDict()
                                                     )
                                                   )
                                                   (intermediate): BertIntermediate(
                                                     (dense): Linear(in_features=768, out_features=3072, bias=True)
                                                   )
                                                   (output): BertOutput(
                                                     (dense): Linear(in_features=3072, out_features=768, bias=True)
                                                     (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
                                                     (dropout): Dropout(p=0.1, inplace=False)
                                                     (adapter_fusion_layer): ModuleDict()
                                                     (layer_text_task_adapters): ModuleDict()
                                                     (layer_text_lang_adapters): ModuleDict()
                                                   )
                                                 )
                                                 (2): BertLayer(
                                                   (attention): BertAttention(
                                                     (self): BertSelfAttention(
                                                       (query): Linear(in_features=768, out_features=768, bias=True)
                                                       (key): Linear(in_features=768, out_features=768, bias=True)
                                                       (value): Linear(in_features=768, out_features=768, bias=True)
                                                       (dropout): Dropout(p=0.1, inplace=False)
                                                     )
                                                     (output): BertSelfOutput(
                                                       (dense): Linear(in_features=768, out_features=768, bias=True)
                                                       (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
                                                       (dropout): Dropout(p=0.1, inplace=False)
                                                       (attention_text_task_adapters): ModuleDict()
                                                       (adapter_fusion_layer): ModuleDict()
                                                       (attention_text_lang_adapters): ModuleDict()
                                                     )
                                                   )
                                                   (intermediate): BertIntermediate(
                                                     (dense): Linear(in_features=768, out_features=3072, bias=True)
                                                   )
                                                   (output): BertOutput(
                                                     (dense): Linear(in_features=3072, out_features=768, bias=True)
                                                     (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
                                                     (dropout): Dropout(p=0.1, inplace=False)
                                                     (adapter_fusion_layer): ModuleDict()
                                                     (layer_text_task_adapters): ModuleDict()
                                                     (layer_text_lang_adapters): ModuleDict()
                                                   )
                                                 )
                                                 (3): BertLayer(
                                                   (attention): BertAttention(
                                                     (self): BertSelfAttention(
                                                       (query): Linear(in_features=768, out_features=768, bias=True)
                                                       (key): Linear(in_features=768, out_features=768, bias=True)
                                                       (value): Linear(in_features=768, out_features=768, bias=True)
                                                       (dropout): Dropout(p=0.1, inplace=False)
                                                     )
                                                     (output): BertSelfOutput(
                                                       (dense): Linear(in_features=768, out_features=768, bias=True)
                                                       (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
                                                       (dropout): Dropout(p=0.1, inplace=False)
                                                       (attention_text_task_adapters): ModuleDict()
                                                       (adapter_fusion_layer): ModuleDict()
                                                       (attention_text_lang_adapters): ModuleDict()
                                                     )
                                                   )
                                                   (intermediate): BertIntermediate(
                                                     (dense): Linear(in_features=768, out_features=3072, bias=True)
                                                   )
                                                   (output): BertOutput(
                                                     (dense): Linear(in_features=3072, out_features=768, bias=True)
                                                     (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
                                                     (dropout): Dropout(p=0.1, inplace=False)
                                                     (adapter_fusion_layer): ModuleDict()
                                                     (layer_text_task_adapters): ModuleDict()
                                                     (layer_text_lang_adapters): ModuleDict()
                                                   )
                                                 )
                                                 (4): BertLayer(
                                                   (attention): BertAttention(
                                                     (self): BertSelfAttention(
                                                       (query): Linear(in_features=768, out_features=768, bias=True)
                                                       (key): Linear(in_features=768, out_features=768, bias=True)
                                                       (value): Linear(in_features=768, out_features=768, bias=True)
                                                       (dropout): Dropout(p=0.1, inplace=False)
                                                     )
                                                     (output): BertSelfOutput(
                                                       (dense): Linear(in_features=768, out_features=768, bias=True)
                                                       (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
                                                       (dropout): Dropout(p=0.1, inplace=False)
                                                       (attention_text_task_adapters): ModuleDict()
                                                       (adapter_fusion_layer): ModuleDict()
                                                       (attention_text_lang_adapters): ModuleDict()
                                                     )
                                                   )
                                                   (intermediate): BertIntermediate(
                                                     (dense): Linear(in_features=768, out_features=3072, bias=True)
                                                   )
                                                   (output): BertOutput(
                                                     (dense): Linear(in_features=3072, out_features=768, bias=True)
                                                     (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
                                                     (dropout): Dropout(p=0.1, inplace=False)
                                                     (adapter_fusion_layer): ModuleDict()
                                                     (layer_text_task_adapters): ModuleDict()
                                                     (layer_text_lang_adapters): ModuleDict()
                                                   )
                                                 )
                                                 (5): BertLayer(
                                                   (attention): BertAttention(
                                                     (self): BertSelfAttention(
                                                       (query): Linear(in_features=768, out_features=768, bias=True)
                                                       (key): Linear(in_features=768, out_features=768, bias=True)
                                                       (value): Linear(in_features=768, out_features=768, bias=True)
                                                       (dropout): Dropout(p=0.1, inplace=False)
                                                     )
                                                     (output): BertSelfOutput(
                                                       (dense): Linear(in_features=768, out_features=768, bias=True)
                                                       (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
                                                       (dropout): Dropout(p=0.1, inplace=False)
                                                       (attention_text_task_adapters): ModuleDict()
                                                       (adapter_fusion_layer): ModuleDict()
                                                       (attention_text_lang_adapters): ModuleDict()
                                                     )
                                                   )
                                                   (intermediate): BertIntermediate(
                                                     (dense): Linear(in_features=768, out_features=3072, bias=True)
                                                   )
                                                   (output): BertOutput(
                                                     (dense): Linear(in_features=3072, out_features=768, bias=True)
                                                     (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
                                                     (dropout): Dropout(p=0.1, inplace=False)
                                                     (adapter_fusion_layer): ModuleDict()
                                                     (layer_text_task_adapters): ModuleDict()
                                                     (layer_text_lang_adapters): ModuleDict()
                                                   )
                                                 )
                                                 (6): BertLayer(
                                                   (attention): BertAttention(
                                                     (self): BertSelfAttention(
                                                       (query): Linear(in_features=768, out_features=768, bias=True)
                                                       (key): Linear(in_features=768, out_features=768, bias=True)
                                                       (value): Linear(in_features=768, out_features=768, bias=True)
                                                       (dropout): Dropout(p=0.1, inplace=False)
                                                     )
                                                     (output): BertSelfOutput(
                                                       (dense): Linear(in_features=768, out_features=768, bias=True)
                                                       (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
                                                       (dropout): Dropout(p=0.1, inplace=False)
                                                       (attention_text_task_adapters): ModuleDict()
                                                       (adapter_fusion_layer): ModuleDict()
                                                       (attention_text_lang_adapters): ModuleDict()
                                                     )
                                                   )
                                                   (intermediate): BertIntermediate(
                                                     (dense): Linear(in_features=768, out_features=3072, bias=True)
                                                   )
                                                   (output): BertOutput(
                                                     (dense): Linear(in_features=3072, out_features=768, bias=True)
                                                     (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
                                                     (dropout): Dropout(p=0.1, inplace=False)
                                                     (adapter_fusion_layer): ModuleDict()
                                                     (layer_text_task_adapters): ModuleDict()
                                                     (layer_text_lang_adapters): ModuleDict()
                                                   )
                                                 )
                                                 (7): BertLayer(
                                                   (attention): BertAttention(
                                                     (self): BertSelfAttention(
                                                       (query): Linear(in_features=768, out_features=768, bias=True)
                                                       (key): Linear(in_features=768, out_features=768, bias=True)
                                                       (value): Linear(in_features=768, out_features=768, bias=True)
                                                       (dropout): Dropout(p=0.1, inplace=False)
                                                     )
                                                     (output): BertSelfOutput(
                                                       (dense): Linear(in_features=768, out_features=768, bias=True)
                                                       (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
                                                       (dropout): Dropout(p=0.1, inplace=False)
                                                       (attention_text_task_adapters): ModuleDict()
                                                       (adapter_fusion_layer): ModuleDict()
                                                       (attention_text_lang_adapters): ModuleDict()
                                                     )
                                                   )
                                                   (intermediate): BertIntermediate(
                                                     (dense): Linear(in_features=768, out_features=3072, bias=True)
                                                   )
                                                   (output): BertOutput(
                                                     (dense): Linear(in_features=3072, out_features=768, bias=True)
                                                     (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
                                                     (dropout): Dropout(p=0.1, inplace=False)
                                                     (adapter_fusion_layer): ModuleDict()
                                                     (layer_text_task_adapters): ModuleDict()
                                                     (layer_text_lang_adapters): ModuleDict()
                                                   )
                                                 )
                                                 (8): BertLayer(
                                                   (attention): BertAttention(
                                                     (self): BertSelfAttention(
                                                       (query): Linear(in_features=768, out_features=768, bias=True)
                                                       (key): Linear(in_features=768, out_features=768, bias=True)
                                                       (value): Linear(in_features=768, out_features=768, bias=True)
                                                       (dropout): Dropout(p=0.1, inplace=False)
                                                     )
                                                     (output): BertSelfOutput(
                                                       (dense): Linear(in_features=768, out_features=768, bias=True)
                                                       (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
                                                       (dropout): Dropout(p=0.1, inplace=False)
                                                       (attention_text_task_adapters): ModuleDict()
                                                       (adapter_fusion_layer): ModuleDict()
                                                       (attention_text_lang_adapters): ModuleDict()
                                                     )
                                                   )
                                                   (intermediate): BertIntermediate(
                                                     (dense): Linear(in_features=768, out_features=3072, bias=True)
                                                   )
                                                   (output): BertOutput(
                                                     (dense): Linear(in_features=3072, out_features=768, bias=True)
                                                     (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
                                                     (dropout): Dropout(p=0.1, inplace=False)
                                                     (adapter_fusion_layer): ModuleDict()
                                                     (layer_text_task_adapters): ModuleDict()
                                                     (layer_text_lang_adapters): ModuleDict()
                                                   )
                                                 )
                                                 (9): BertLayer(
                                                   (attention): BertAttention(
                                                     (self): BertSelfAttention(
                                                       (query): Linear(in_features=768, out_features=768, bias=True)
                                                       (key): Linear(in_features=768, out_features=768, bias=True)
                                                       (value): Linear(in_features=768, out_features=768, bias=True)
                                                       (dropout): Dropout(p=0.1, inplace=False)
                                                     )
                                                     (output): BertSelfOutput(
                                                       (dense): Linear(in_features=768, out_features=768, bias=True)
                                                       (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
                                                       (dropout): Dropout(p=0.1, inplace=False)
                                                       (attention_text_task_adapters): ModuleDict()
                                                       (adapter_fusion_layer): ModuleDict()
                                                       (attention_text_lang_adapters): ModuleDict()
                                                     )
                                                   )
                                                   (intermediate): BertIntermediate(
                                                     (dense): Linear(in_features=768, out_features=3072, bias=True)
                                                   )
                                                   (output): BertOutput(
                                                     (dense): Linear(in_features=3072, out_features=768, bias=True)
                                                     (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
                                                     (dropout): Dropout(p=0.1, inplace=False)
                                                     (adapter_fusion_layer): ModuleDict()
                                                     (layer_text_task_adapters): ModuleDict()
                                                     (layer_text_lang_adapters): ModuleDict()
                                                   )
                                                 )
                                                 (10): BertLayer(
                                                   (attention): BertAttention(
                                                     (self): BertSelfAttention(
                                                       (query): Linear(in_features=768, out_features=768, bias=True)
                                                       (key): Linear(in_features=768, out_features=768, bias=True)
                                                       (value): Linear(in_features=768, out_features=768, bias=True)
                                                       (dropout): Dropout(p=0.1, inplace=False)
                                                     )
                                                     (output): BertSelfOutput(
                                                       (dense): Linear(in_features=768, out_features=768, bias=True)
                                                       (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
                                                       (dropout): Dropout(p=0.1, inplace=False)
                                                       (attention_text_task_adapters): ModuleDict()
                                                       (adapter_fusion_layer): ModuleDict()
                                                       (attention_text_lang_adapters): ModuleDict()
                                                     )
                                                   )
                                                   (intermediate): BertIntermediate(
                                                     (dense): Linear(in_features=768, out_features=3072, bias=True)
                                                   )
                                                   (output): BertOutput(
                                                     (dense): Linear(in_features=3072, out_features=768, bias=True)
                                                     (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
                                                     (dropout): Dropout(p=0.1, inplace=False)
                                                     (adapter_fusion_layer): ModuleDict()
                                                     (layer_text_task_adapters): ModuleDict()
                                                     (layer_text_lang_adapters): ModuleDict()
                                                   )
                                                 )
                                                 (11): BertLayer(
                                                   (attention): BertAttention(
                                                     (self): BertSelfAttention(
                                                       (query): Linear(in_features=768, out_features=768, bias=True)
                                                       (key): Linear(in_features=768, out_features=768, bias=True)
                                                       (value): Linear(in_features=768, out_features=768, bias=True)
                                                       (dropout): Dropout(p=0.1, inplace=False)
                                                     )
                                                     (output): BertSelfOutput(
                                                       (dense): Linear(in_features=768, out_features=768, bias=True)
                                                       (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
                                                       (dropout): Dropout(p=0.1, inplace=False)
                                                       (attention_text_task_adapters): ModuleDict()
                                                       (adapter_fusion_layer): ModuleDict()
                                                       (attention_text_lang_adapters): ModuleDict()
                                                     )
                                                   )
                                                   (intermediate): BertIntermediate(
                                                     (dense): Linear(in_features=768, out_features=3072, bias=True)
                                                   )
                                                   (output): BertOutput(
                                                     (dense): Linear(in_features=3072, out_features=768, bias=True)
                                                     (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
                                                     (dropout): Dropout(p=0.1, inplace=False)
                                                     (adapter_fusion_layer): ModuleDict()
                                                     (layer_text_task_adapters): ModuleDict()
                                                     (layer_text_lang_adapters): ModuleDict()
                                                   )
                                                 )
                                               )
                                             )
                                             (pooler): BertPooler(
                                               (dense): Linear(in_features=768, out_features=768, bias=True)
                                               (activation): Tanh()
                                             )
                                             (invertible_lang_adapters): ModuleDict()
                                           )
                                         )
                                         (audio_enc): AudioEncoder(
                                           (conv_layers): ModuleList(
                                             (0): Conv1d(96, 96, kernel_size=(128,), stride=(2,))
                                             (1): Conv1d(96, 96, kernel_size=(128,), stride=(2,))
                                             (2): AdaptiveAvgPool1d(output_size=200)
                                           )
                                         )
                                         (proj_poster): Linear(in_features=4096, out_features=768, bias=False)
                                         (proj2_poster): Linear(in_features=4096, out_features=768, bias=False)
                                         (proj_l_e): Linear(in_features=768, out_features=768, bias=False)
                                         (proj_v_e): Linear(in_features=4096, out_features=768, bias=False)
                                         (proj_a_e): Linear(in_features=96, out_features=768, bias=False)
                                         (proj_l): Conv1d(768, 768, kernel_size=(1,), stride=(1,), bias=False)
                                         (proj_v): Conv1d(4096, 768, kernel_size=(1,), stride=(1,), bias=False)
                                         (proj_a): Conv1d(96, 768, kernel_size=(1,), stride=(1,), bias=False)
                                         (trans_l_with_a): TransformerEncoder(
                                           (embed_positions): SinusoidalPositionalEmbedding()
                                           (layers): ModuleList(
                                             (0): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=768, out_features=768, bias=True)
                                               )
                                               (fc1): Linear(in_features=768, out_features=3072, bias=True)
                                               (fc2): Linear(in_features=3072, out_features=768, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                             (1): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=768, out_features=768, bias=True)
                                               )
                                               (fc1): Linear(in_features=768, out_features=3072, bias=True)
                                               (fc2): Linear(in_features=3072, out_features=768, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                             (2): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=768, out_features=768, bias=True)
                                               )
                                               (fc1): Linear(in_features=768, out_features=3072, bias=True)
                                               (fc2): Linear(in_features=3072, out_features=768, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                             (3): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=768, out_features=768, bias=True)
                                               )
                                               (fc1): Linear(in_features=768, out_features=3072, bias=True)
                                               (fc2): Linear(in_features=3072, out_features=768, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                             (4): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=768, out_features=768, bias=True)
                                               )
                                               (fc1): Linear(in_features=768, out_features=3072, bias=True)
                                               (fc2): Linear(in_features=3072, out_features=768, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                           )
                                           (layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                         )
                                         (trans_l_with_v): TransformerEncoder(
                                           (embed_positions): SinusoidalPositionalEmbedding()
                                           (layers): ModuleList(
                                             (0): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=768, out_features=768, bias=True)
                                               )
                                               (fc1): Linear(in_features=768, out_features=3072, bias=True)
                                               (fc2): Linear(in_features=3072, out_features=768, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                             (1): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=768, out_features=768, bias=True)
                                               )
                                               (fc1): Linear(in_features=768, out_features=3072, bias=True)
                                               (fc2): Linear(in_features=3072, out_features=768, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                             (2): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=768, out_features=768, bias=True)
                                               )
                                               (fc1): Linear(in_features=768, out_features=3072, bias=True)
                                               (fc2): Linear(in_features=3072, out_features=768, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                             (3): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=768, out_features=768, bias=True)
                                               )
                                               (fc1): Linear(in_features=768, out_features=3072, bias=True)
                                               (fc2): Linear(in_features=3072, out_features=768, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                             (4): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=768, out_features=768, bias=True)
                                               )
                                               (fc1): Linear(in_features=768, out_features=3072, bias=True)
                                               (fc2): Linear(in_features=3072, out_features=768, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                           )
                                           (layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                         )
                                         (trans_v_with_l): TransformerEncoder(
                                           (embed_positions): SinusoidalPositionalEmbedding()
                                           (layers): ModuleList(
                                             (0): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=768, out_features=768, bias=True)
                                               )
                                               (fc1): Linear(in_features=768, out_features=3072, bias=True)
                                               (fc2): Linear(in_features=3072, out_features=768, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                             (1): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=768, out_features=768, bias=True)
                                               )
                                               (fc1): Linear(in_features=768, out_features=3072, bias=True)
                                               (fc2): Linear(in_features=3072, out_features=768, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                             (2): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=768, out_features=768, bias=True)
                                               )
                                               (fc1): Linear(in_features=768, out_features=3072, bias=True)
                                               (fc2): Linear(in_features=3072, out_features=768, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                             (3): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=768, out_features=768, bias=True)
                                               )
                                               (fc1): Linear(in_features=768, out_features=3072, bias=True)
                                               (fc2): Linear(in_features=3072, out_features=768, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                             (4): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=768, out_features=768, bias=True)
                                               )
                                               (fc1): Linear(in_features=768, out_features=3072, bias=True)
                                               (fc2): Linear(in_features=3072, out_features=768, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                           )
                                           (layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                         )
                                         (trans_v_with_a): TransformerEncoder(
                                           (embed_positions): SinusoidalPositionalEmbedding()
                                           (layers): ModuleList(
                                             (0): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=768, out_features=768, bias=True)
                                               )
                                               (fc1): Linear(in_features=768, out_features=3072, bias=True)
                                               (fc2): Linear(in_features=3072, out_features=768, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                             (1): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=768, out_features=768, bias=True)
                                               )
                                               (fc1): Linear(in_features=768, out_features=3072, bias=True)
                                               (fc2): Linear(in_features=3072, out_features=768, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                             (2): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=768, out_features=768, bias=True)
                                               )
                                               (fc1): Linear(in_features=768, out_features=3072, bias=True)
                                               (fc2): Linear(in_features=3072, out_features=768, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                             (3): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=768, out_features=768, bias=True)
                                               )
                                               (fc1): Linear(in_features=768, out_features=3072, bias=True)
                                               (fc2): Linear(in_features=3072, out_features=768, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                             (4): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=768, out_features=768, bias=True)
                                               )
                                               (fc1): Linear(in_features=768, out_features=3072, bias=True)
                                               (fc2): Linear(in_features=3072, out_features=768, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                           )
                                           (layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                         )
                                         (trans_a_with_l): TransformerEncoder(
                                           (embed_positions): SinusoidalPositionalEmbedding()
                                           (layers): ModuleList(
                                             (0): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=768, out_features=768, bias=True)
                                               )
                                               (fc1): Linear(in_features=768, out_features=3072, bias=True)
                                               (fc2): Linear(in_features=3072, out_features=768, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                             (1): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=768, out_features=768, bias=True)
                                               )
                                               (fc1): Linear(in_features=768, out_features=3072, bias=True)
                                               (fc2): Linear(in_features=3072, out_features=768, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                             (2): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=768, out_features=768, bias=True)
                                               )
                                               (fc1): Linear(in_features=768, out_features=3072, bias=True)
                                               (fc2): Linear(in_features=3072, out_features=768, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                             (3): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=768, out_features=768, bias=True)
                                               )
                                               (fc1): Linear(in_features=768, out_features=3072, bias=True)
                                               (fc2): Linear(in_features=3072, out_features=768, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                             (4): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=768, out_features=768, bias=True)
                                               )
                                               (fc1): Linear(in_features=768, out_features=3072, bias=True)
                                               (fc2): Linear(in_features=3072, out_features=768, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                           )
                                           (layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                         )
                                         (trans_a_with_v): TransformerEncoder(
                                           (embed_positions): SinusoidalPositionalEmbedding()
                                           (layers): ModuleList(
                                             (0): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=768, out_features=768, bias=True)
                                               )
                                               (fc1): Linear(in_features=768, out_features=3072, bias=True)
                                               (fc2): Linear(in_features=3072, out_features=768, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                             (1): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=768, out_features=768, bias=True)
                                               )
                                               (fc1): Linear(in_features=768, out_features=3072, bias=True)
                                               (fc2): Linear(in_features=3072, out_features=768, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                             (2): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=768, out_features=768, bias=True)
                                               )
                                               (fc1): Linear(in_features=768, out_features=3072, bias=True)
                                               (fc2): Linear(in_features=3072, out_features=768, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                             (3): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=768, out_features=768, bias=True)
                                               )
                                               (fc1): Linear(in_features=768, out_features=3072, bias=True)
                                               (fc2): Linear(in_features=3072, out_features=768, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                             (4): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=768, out_features=768, bias=True)
                                               )
                                               (fc1): Linear(in_features=768, out_features=3072, bias=True)
                                               (fc2): Linear(in_features=3072, out_features=768, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                           )
                                           (layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                         )
                                         (trans_l_mem): TransformerEncoder(
                                           (embed_positions): SinusoidalPositionalEmbedding()
                                           (layers): ModuleList(
                                             (0): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=1536, out_features=1536, bias=True)
                                               )
                                               (fc1): Linear(in_features=1536, out_features=6144, bias=True)
                                               (fc2): Linear(in_features=6144, out_features=1536, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                             (1): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=1536, out_features=1536, bias=True)
                                               )
                                               (fc1): Linear(in_features=1536, out_features=6144, bias=True)
                                               (fc2): Linear(in_features=6144, out_features=1536, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                             (2): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=1536, out_features=1536, bias=True)
                                               )
                                               (fc1): Linear(in_features=1536, out_features=6144, bias=True)
                                               (fc2): Linear(in_features=6144, out_features=1536, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                             (3): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=1536, out_features=1536, bias=True)
                                               )
                                               (fc1): Linear(in_features=1536, out_features=6144, bias=True)
                                               (fc2): Linear(in_features=6144, out_features=1536, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                             (4): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=1536, out_features=1536, bias=True)
                                               )
                                               (fc1): Linear(in_features=1536, out_features=6144, bias=True)
                                               (fc2): Linear(in_features=6144, out_features=1536, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                           )
                                           (layer_norm): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
                                         )
                                         (trans_v_mem): TransformerEncoder(
                                           (embed_positions): SinusoidalPositionalEmbedding()
                                           (layers): ModuleList(
                                             (0): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=1536, out_features=1536, bias=True)
                                               )
                                               (fc1): Linear(in_features=1536, out_features=6144, bias=True)
                                               (fc2): Linear(in_features=6144, out_features=1536, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                             (1): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=1536, out_features=1536, bias=True)
                                               )
                                               (fc1): Linear(in_features=1536, out_features=6144, bias=True)
                                               (fc2): Linear(in_features=6144, out_features=1536, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                             (2): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=1536, out_features=1536, bias=True)
                                               )
                                               (fc1): Linear(in_features=1536, out_features=6144, bias=True)
                                               (fc2): Linear(in_features=6144, out_features=1536, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                             (3): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=1536, out_features=1536, bias=True)
                                               )
                                               (fc1): Linear(in_features=1536, out_features=6144, bias=True)
                                               (fc2): Linear(in_features=6144, out_features=1536, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                             (4): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=1536, out_features=1536, bias=True)
                                               )
                                               (fc1): Linear(in_features=1536, out_features=6144, bias=True)
                                               (fc2): Linear(in_features=6144, out_features=1536, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                           )
                                           (layer_norm): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
                                         )
                                         (trans_a_mem): TransformerEncoder(
                                           (embed_positions): SinusoidalPositionalEmbedding()
                                           (layers): ModuleList(
                                             (0): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=1536, out_features=1536, bias=True)
                                               )
                                               (fc1): Linear(in_features=1536, out_features=6144, bias=True)
                                               (fc2): Linear(in_features=6144, out_features=1536, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                             (1): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=1536, out_features=1536, bias=True)
                                               )
                                               (fc1): Linear(in_features=1536, out_features=6144, bias=True)
                                               (fc2): Linear(in_features=6144, out_features=1536, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                             (2): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=1536, out_features=1536, bias=True)
                                               )
                                               (fc1): Linear(in_features=1536, out_features=6144, bias=True)
                                               (fc2): Linear(in_features=6144, out_features=1536, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                             (3): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=1536, out_features=1536, bias=True)
                                               )
                                               (fc1): Linear(in_features=1536, out_features=6144, bias=True)
                                               (fc2): Linear(in_features=6144, out_features=1536, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                             (4): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=1536, out_features=1536, bias=True)
                                               )
                                               (fc1): Linear(in_features=1536, out_features=6144, bias=True)
                                               (fc2): Linear(in_features=6144, out_features=1536, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                           )
                                           (layer_norm): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
                                         )
                                         (proj1): Linear(in_features=768, out_features=768, bias=True)
                                         (proj2): Linear(in_features=768, out_features=768, bias=True)
                                         (out_layer): Linear(in_features=768, out_features=13, bias=True)
                                         (proj12): Linear(in_features=768, out_features=768, bias=True)
                                         (proj22): Linear(in_features=768, out_features=768, bias=True)
                                         (out_layer2): Linear(in_features=768, out_features=13, bias=True)
                                         (out_layer_final): Linear(in_features=13, out_features=13, bias=True)
                                         (gmu): TextShifting4Layer(
                                           (hidden1): Linear(in_features=1536, out_features=768, bias=False)
                                           (hidden2): Linear(in_features=1536, out_features=768, bias=False)
                                           (hidden3): Linear(in_features=1536, out_features=768, bias=False)
                                           (hidden4): Linear(in_features=768, out_features=768, bias=False)
                                           (x1_gate): Linear(in_features=5376, out_features=768, bias=False)
                                           (x2_gate): Linear(in_features=5376, out_features=768, bias=False)
                                           (x3_gate): Linear(in_features=5376, out_features=768, bias=False)
                                           (x4_gate): Linear(in_features=5376, out_features=768, bias=False)
                                         )
                                         (gmuSimple): TextShifting4LayerSimple(
                                           (hidden1): Linear(in_features=768, out_features=768, bias=False)
                                           (hidden2): Linear(in_features=768, out_features=768, bias=False)
                                           (hidden3): Linear(in_features=768, out_features=768, bias=False)
                                           (hidden4): Linear(in_features=768, out_features=768, bias=False)
                                           (x1_gate): Linear(in_features=768, out_features=768, bias=False)
                                           (x2_gate): Linear(in_features=768, out_features=768, bias=False)
                                           (x3_gate): Linear(in_features=768, out_features=768, bias=False)
                                           (x4_gate): Linear(in_features=768, out_features=768, bias=False)
                                         )
                                       )
                                     )
INFO - 09/07/21 23:24:54 - 0:00:01 - Training..
INFO - 09/07/21 23:30:37 - 0:00:00 - a_len: 3
                                     adapter_size: 64
                                     aonly: True
                                     attn_dropout: 0.1
                                     attn_dropout_a: 0.0
                                     attn_dropout_v: 0.0
                                     attn_mask: True
                                     batch_sz: 8
                                     bert_model: bert-base-uncased
                                     chunk_size: 100
                                     config_file: /home/est_posgrado_diego.moreno/vilbert-multi-task/config/bert_base_6layer_6conect.json
                                     data_path: /home/est_posgrado_diego.moreno/Workspace/Tesis/multimodal-transformers-movies/datasets
                                     drop_img_percent: 0.0
                                     dropout: 0.1
                                     embed_dropout: 0.25
                                     embed_sz: 300
                                     freeze_img: 0
                                     freeze_txt: 0
                                     from_pretrained: /home/est_posgrado_diego.moreno/vilbert-multi-task/save/multi_task_model.bin
                                     glove_path: /path/to/glove_embeds/glove.840B.300d.txt
                                     gradient_accumulation_steps: 16
                                     hidden: []
                                     hidden_sz: 768
                                     img_embed_pool_type: avg
                                     img_hidden_sz: 2048
                                     include_bn: True
                                     l_len: 512
                                     label_freqs: Counter({'Drama': 1803, 'Comedy': 1276, 'Thriller': 1010, 'Action': 825, 'Romance': 767, 'Fantasy': 665, 'Crime': 610, 'Sci-Fi': 424, 'Horror': 395, 'Family': 385, 'Mystery': 343, 'Biography': 207, 'Animation': 175})
                                     labels: ['Mystery', 'Thriller', 'Comedy', 'Action', 'Crime', 'Drama', 'Fantasy', 'Family', 'Horror', 'Biography', 'Romance', 'Sci-Fi', 'Animation']
                                     layers: 5
                                     lonly: True
                                     lr: 5e-05
                                     lr_factor: 0.5
                                     lr_patience: 2
                                     max_epochs: 100
                                     max_seq_len: 512
                                     model: mmtrvapt
                                     n_classes: 13
                                     n_workers: 12
                                     name: moviescope_Seed1_mmbt_model_run
                                     nlevels: 5
                                     num_heads: 6
                                     num_image_embeds: 3
                                     num_images: 8
                                     orig_d_a: 96
                                     orig_d_l: 768
                                     orig_d_m: 312
                                     orig_d_v: 4096
                                     out_dropout: 0.0
                                     output_gates: False
                                     patience: 5
                                     pooling: cls
                                     relu_dropout: 0.1
                                     res_dropout: 0.1
                                     savedir: /home/est_posgrado_diego.moreno/Workspace/Tesis/multimodal-transformers-movies/model_save_mmtr_hybrid_v4/moviescope_Seed1_mmbt_model_run
                                     seed: 1
                                     task: moviescope
                                     task_type: multilabel
                                     train_data_len: 3449
                                     train_type: split
                                     trained_model_dir: 
                                     v_len: 3
                                     vision_scratch: False
                                     visual: both
                                     vocab: <mmbt.data.vocab.Vocab object at 0x7fe5c16f6f10>
                                     vocab_sz: 30522
                                     vonly: True
                                     warmup: 0.1
                                     weight_classes: 1
INFO - 09/07/21 23:30:37 - 0:00:00 - DataParallel(
                                       (module): MMTransformerGMUHybridClf(
                                         (enc): BertEncoder(
                                           (bert): BertModel(
                                             (embeddings): BertEmbeddings(
                                               (word_embeddings): Embedding(30522, 768, padding_idx=0)
                                               (position_embeddings): Embedding(512, 768)
                                               (token_type_embeddings): Embedding(2, 768)
                                               (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
                                               (dropout): Dropout(p=0.1, inplace=False)
                                             )
                                             (encoder): BertEncoder(
                                               (layer): ModuleList(
                                                 (0): BertLayer(
                                                   (attention): BertAttention(
                                                     (self): BertSelfAttention(
                                                       (query): Linear(in_features=768, out_features=768, bias=True)
                                                       (key): Linear(in_features=768, out_features=768, bias=True)
                                                       (value): Linear(in_features=768, out_features=768, bias=True)
                                                       (dropout): Dropout(p=0.1, inplace=False)
                                                     )
                                                     (output): BertSelfOutput(
                                                       (dense): Linear(in_features=768, out_features=768, bias=True)
                                                       (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
                                                       (dropout): Dropout(p=0.1, inplace=False)
                                                       (attention_text_task_adapters): ModuleDict()
                                                       (adapter_fusion_layer): ModuleDict()
                                                       (attention_text_lang_adapters): ModuleDict()
                                                     )
                                                   )
                                                   (intermediate): BertIntermediate(
                                                     (dense): Linear(in_features=768, out_features=3072, bias=True)
                                                   )
                                                   (output): BertOutput(
                                                     (dense): Linear(in_features=3072, out_features=768, bias=True)
                                                     (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
                                                     (dropout): Dropout(p=0.1, inplace=False)
                                                     (adapter_fusion_layer): ModuleDict()
                                                     (layer_text_task_adapters): ModuleDict()
                                                     (layer_text_lang_adapters): ModuleDict()
                                                   )
                                                 )
                                                 (1): BertLayer(
                                                   (attention): BertAttention(
                                                     (self): BertSelfAttention(
                                                       (query): Linear(in_features=768, out_features=768, bias=True)
                                                       (key): Linear(in_features=768, out_features=768, bias=True)
                                                       (value): Linear(in_features=768, out_features=768, bias=True)
                                                       (dropout): Dropout(p=0.1, inplace=False)
                                                     )
                                                     (output): BertSelfOutput(
                                                       (dense): Linear(in_features=768, out_features=768, bias=True)
                                                       (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
                                                       (dropout): Dropout(p=0.1, inplace=False)
                                                       (attention_text_task_adapters): ModuleDict()
                                                       (adapter_fusion_layer): ModuleDict()
                                                       (attention_text_lang_adapters): ModuleDict()
                                                     )
                                                   )
                                                   (intermediate): BertIntermediate(
                                                     (dense): Linear(in_features=768, out_features=3072, bias=True)
                                                   )
                                                   (output): BertOutput(
                                                     (dense): Linear(in_features=3072, out_features=768, bias=True)
                                                     (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
                                                     (dropout): Dropout(p=0.1, inplace=False)
                                                     (adapter_fusion_layer): ModuleDict()
                                                     (layer_text_task_adapters): ModuleDict()
                                                     (layer_text_lang_adapters): ModuleDict()
                                                   )
                                                 )
                                                 (2): BertLayer(
                                                   (attention): BertAttention(
                                                     (self): BertSelfAttention(
                                                       (query): Linear(in_features=768, out_features=768, bias=True)
                                                       (key): Linear(in_features=768, out_features=768, bias=True)
                                                       (value): Linear(in_features=768, out_features=768, bias=True)
                                                       (dropout): Dropout(p=0.1, inplace=False)
                                                     )
                                                     (output): BertSelfOutput(
                                                       (dense): Linear(in_features=768, out_features=768, bias=True)
                                                       (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
                                                       (dropout): Dropout(p=0.1, inplace=False)
                                                       (attention_text_task_adapters): ModuleDict()
                                                       (adapter_fusion_layer): ModuleDict()
                                                       (attention_text_lang_adapters): ModuleDict()
                                                     )
                                                   )
                                                   (intermediate): BertIntermediate(
                                                     (dense): Linear(in_features=768, out_features=3072, bias=True)
                                                   )
                                                   (output): BertOutput(
                                                     (dense): Linear(in_features=3072, out_features=768, bias=True)
                                                     (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
                                                     (dropout): Dropout(p=0.1, inplace=False)
                                                     (adapter_fusion_layer): ModuleDict()
                                                     (layer_text_task_adapters): ModuleDict()
                                                     (layer_text_lang_adapters): ModuleDict()
                                                   )
                                                 )
                                                 (3): BertLayer(
                                                   (attention): BertAttention(
                                                     (self): BertSelfAttention(
                                                       (query): Linear(in_features=768, out_features=768, bias=True)
                                                       (key): Linear(in_features=768, out_features=768, bias=True)
                                                       (value): Linear(in_features=768, out_features=768, bias=True)
                                                       (dropout): Dropout(p=0.1, inplace=False)
                                                     )
                                                     (output): BertSelfOutput(
                                                       (dense): Linear(in_features=768, out_features=768, bias=True)
                                                       (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
                                                       (dropout): Dropout(p=0.1, inplace=False)
                                                       (attention_text_task_adapters): ModuleDict()
                                                       (adapter_fusion_layer): ModuleDict()
                                                       (attention_text_lang_adapters): ModuleDict()
                                                     )
                                                   )
                                                   (intermediate): BertIntermediate(
                                                     (dense): Linear(in_features=768, out_features=3072, bias=True)
                                                   )
                                                   (output): BertOutput(
                                                     (dense): Linear(in_features=3072, out_features=768, bias=True)
                                                     (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
                                                     (dropout): Dropout(p=0.1, inplace=False)
                                                     (adapter_fusion_layer): ModuleDict()
                                                     (layer_text_task_adapters): ModuleDict()
                                                     (layer_text_lang_adapters): ModuleDict()
                                                   )
                                                 )
                                                 (4): BertLayer(
                                                   (attention): BertAttention(
                                                     (self): BertSelfAttention(
                                                       (query): Linear(in_features=768, out_features=768, bias=True)
                                                       (key): Linear(in_features=768, out_features=768, bias=True)
                                                       (value): Linear(in_features=768, out_features=768, bias=True)
                                                       (dropout): Dropout(p=0.1, inplace=False)
                                                     )
                                                     (output): BertSelfOutput(
                                                       (dense): Linear(in_features=768, out_features=768, bias=True)
                                                       (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
                                                       (dropout): Dropout(p=0.1, inplace=False)
                                                       (attention_text_task_adapters): ModuleDict()
                                                       (adapter_fusion_layer): ModuleDict()
                                                       (attention_text_lang_adapters): ModuleDict()
                                                     )
                                                   )
                                                   (intermediate): BertIntermediate(
                                                     (dense): Linear(in_features=768, out_features=3072, bias=True)
                                                   )
                                                   (output): BertOutput(
                                                     (dense): Linear(in_features=3072, out_features=768, bias=True)
                                                     (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
                                                     (dropout): Dropout(p=0.1, inplace=False)
                                                     (adapter_fusion_layer): ModuleDict()
                                                     (layer_text_task_adapters): ModuleDict()
                                                     (layer_text_lang_adapters): ModuleDict()
                                                   )
                                                 )
                                                 (5): BertLayer(
                                                   (attention): BertAttention(
                                                     (self): BertSelfAttention(
                                                       (query): Linear(in_features=768, out_features=768, bias=True)
                                                       (key): Linear(in_features=768, out_features=768, bias=True)
                                                       (value): Linear(in_features=768, out_features=768, bias=True)
                                                       (dropout): Dropout(p=0.1, inplace=False)
                                                     )
                                                     (output): BertSelfOutput(
                                                       (dense): Linear(in_features=768, out_features=768, bias=True)
                                                       (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
                                                       (dropout): Dropout(p=0.1, inplace=False)
                                                       (attention_text_task_adapters): ModuleDict()
                                                       (adapter_fusion_layer): ModuleDict()
                                                       (attention_text_lang_adapters): ModuleDict()
                                                     )
                                                   )
                                                   (intermediate): BertIntermediate(
                                                     (dense): Linear(in_features=768, out_features=3072, bias=True)
                                                   )
                                                   (output): BertOutput(
                                                     (dense): Linear(in_features=3072, out_features=768, bias=True)
                                                     (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
                                                     (dropout): Dropout(p=0.1, inplace=False)
                                                     (adapter_fusion_layer): ModuleDict()
                                                     (layer_text_task_adapters): ModuleDict()
                                                     (layer_text_lang_adapters): ModuleDict()
                                                   )
                                                 )
                                                 (6): BertLayer(
                                                   (attention): BertAttention(
                                                     (self): BertSelfAttention(
                                                       (query): Linear(in_features=768, out_features=768, bias=True)
                                                       (key): Linear(in_features=768, out_features=768, bias=True)
                                                       (value): Linear(in_features=768, out_features=768, bias=True)
                                                       (dropout): Dropout(p=0.1, inplace=False)
                                                     )
                                                     (output): BertSelfOutput(
                                                       (dense): Linear(in_features=768, out_features=768, bias=True)
                                                       (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
                                                       (dropout): Dropout(p=0.1, inplace=False)
                                                       (attention_text_task_adapters): ModuleDict()
                                                       (adapter_fusion_layer): ModuleDict()
                                                       (attention_text_lang_adapters): ModuleDict()
                                                     )
                                                   )
                                                   (intermediate): BertIntermediate(
                                                     (dense): Linear(in_features=768, out_features=3072, bias=True)
                                                   )
                                                   (output): BertOutput(
                                                     (dense): Linear(in_features=3072, out_features=768, bias=True)
                                                     (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
                                                     (dropout): Dropout(p=0.1, inplace=False)
                                                     (adapter_fusion_layer): ModuleDict()
                                                     (layer_text_task_adapters): ModuleDict()
                                                     (layer_text_lang_adapters): ModuleDict()
                                                   )
                                                 )
                                                 (7): BertLayer(
                                                   (attention): BertAttention(
                                                     (self): BertSelfAttention(
                                                       (query): Linear(in_features=768, out_features=768, bias=True)
                                                       (key): Linear(in_features=768, out_features=768, bias=True)
                                                       (value): Linear(in_features=768, out_features=768, bias=True)
                                                       (dropout): Dropout(p=0.1, inplace=False)
                                                     )
                                                     (output): BertSelfOutput(
                                                       (dense): Linear(in_features=768, out_features=768, bias=True)
                                                       (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
                                                       (dropout): Dropout(p=0.1, inplace=False)
                                                       (attention_text_task_adapters): ModuleDict()
                                                       (adapter_fusion_layer): ModuleDict()
                                                       (attention_text_lang_adapters): ModuleDict()
                                                     )
                                                   )
                                                   (intermediate): BertIntermediate(
                                                     (dense): Linear(in_features=768, out_features=3072, bias=True)
                                                   )
                                                   (output): BertOutput(
                                                     (dense): Linear(in_features=3072, out_features=768, bias=True)
                                                     (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
                                                     (dropout): Dropout(p=0.1, inplace=False)
                                                     (adapter_fusion_layer): ModuleDict()
                                                     (layer_text_task_adapters): ModuleDict()
                                                     (layer_text_lang_adapters): ModuleDict()
                                                   )
                                                 )
                                                 (8): BertLayer(
                                                   (attention): BertAttention(
                                                     (self): BertSelfAttention(
                                                       (query): Linear(in_features=768, out_features=768, bias=True)
                                                       (key): Linear(in_features=768, out_features=768, bias=True)
                                                       (value): Linear(in_features=768, out_features=768, bias=True)
                                                       (dropout): Dropout(p=0.1, inplace=False)
                                                     )
                                                     (output): BertSelfOutput(
                                                       (dense): Linear(in_features=768, out_features=768, bias=True)
                                                       (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
                                                       (dropout): Dropout(p=0.1, inplace=False)
                                                       (attention_text_task_adapters): ModuleDict()
                                                       (adapter_fusion_layer): ModuleDict()
                                                       (attention_text_lang_adapters): ModuleDict()
                                                     )
                                                   )
                                                   (intermediate): BertIntermediate(
                                                     (dense): Linear(in_features=768, out_features=3072, bias=True)
                                                   )
                                                   (output): BertOutput(
                                                     (dense): Linear(in_features=3072, out_features=768, bias=True)
                                                     (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
                                                     (dropout): Dropout(p=0.1, inplace=False)
                                                     (adapter_fusion_layer): ModuleDict()
                                                     (layer_text_task_adapters): ModuleDict()
                                                     (layer_text_lang_adapters): ModuleDict()
                                                   )
                                                 )
                                                 (9): BertLayer(
                                                   (attention): BertAttention(
                                                     (self): BertSelfAttention(
                                                       (query): Linear(in_features=768, out_features=768, bias=True)
                                                       (key): Linear(in_features=768, out_features=768, bias=True)
                                                       (value): Linear(in_features=768, out_features=768, bias=True)
                                                       (dropout): Dropout(p=0.1, inplace=False)
                                                     )
                                                     (output): BertSelfOutput(
                                                       (dense): Linear(in_features=768, out_features=768, bias=True)
                                                       (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
                                                       (dropout): Dropout(p=0.1, inplace=False)
                                                       (attention_text_task_adapters): ModuleDict()
                                                       (adapter_fusion_layer): ModuleDict()
                                                       (attention_text_lang_adapters): ModuleDict()
                                                     )
                                                   )
                                                   (intermediate): BertIntermediate(
                                                     (dense): Linear(in_features=768, out_features=3072, bias=True)
                                                   )
                                                   (output): BertOutput(
                                                     (dense): Linear(in_features=3072, out_features=768, bias=True)
                                                     (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
                                                     (dropout): Dropout(p=0.1, inplace=False)
                                                     (adapter_fusion_layer): ModuleDict()
                                                     (layer_text_task_adapters): ModuleDict()
                                                     (layer_text_lang_adapters): ModuleDict()
                                                   )
                                                 )
                                                 (10): BertLayer(
                                                   (attention): BertAttention(
                                                     (self): BertSelfAttention(
                                                       (query): Linear(in_features=768, out_features=768, bias=True)
                                                       (key): Linear(in_features=768, out_features=768, bias=True)
                                                       (value): Linear(in_features=768, out_features=768, bias=True)
                                                       (dropout): Dropout(p=0.1, inplace=False)
                                                     )
                                                     (output): BertSelfOutput(
                                                       (dense): Linear(in_features=768, out_features=768, bias=True)
                                                       (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
                                                       (dropout): Dropout(p=0.1, inplace=False)
                                                       (attention_text_task_adapters): ModuleDict()
                                                       (adapter_fusion_layer): ModuleDict()
                                                       (attention_text_lang_adapters): ModuleDict()
                                                     )
                                                   )
                                                   (intermediate): BertIntermediate(
                                                     (dense): Linear(in_features=768, out_features=3072, bias=True)
                                                   )
                                                   (output): BertOutput(
                                                     (dense): Linear(in_features=3072, out_features=768, bias=True)
                                                     (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
                                                     (dropout): Dropout(p=0.1, inplace=False)
                                                     (adapter_fusion_layer): ModuleDict()
                                                     (layer_text_task_adapters): ModuleDict()
                                                     (layer_text_lang_adapters): ModuleDict()
                                                   )
                                                 )
                                                 (11): BertLayer(
                                                   (attention): BertAttention(
                                                     (self): BertSelfAttention(
                                                       (query): Linear(in_features=768, out_features=768, bias=True)
                                                       (key): Linear(in_features=768, out_features=768, bias=True)
                                                       (value): Linear(in_features=768, out_features=768, bias=True)
                                                       (dropout): Dropout(p=0.1, inplace=False)
                                                     )
                                                     (output): BertSelfOutput(
                                                       (dense): Linear(in_features=768, out_features=768, bias=True)
                                                       (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
                                                       (dropout): Dropout(p=0.1, inplace=False)
                                                       (attention_text_task_adapters): ModuleDict()
                                                       (adapter_fusion_layer): ModuleDict()
                                                       (attention_text_lang_adapters): ModuleDict()
                                                     )
                                                   )
                                                   (intermediate): BertIntermediate(
                                                     (dense): Linear(in_features=768, out_features=3072, bias=True)
                                                   )
                                                   (output): BertOutput(
                                                     (dense): Linear(in_features=3072, out_features=768, bias=True)
                                                     (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
                                                     (dropout): Dropout(p=0.1, inplace=False)
                                                     (adapter_fusion_layer): ModuleDict()
                                                     (layer_text_task_adapters): ModuleDict()
                                                     (layer_text_lang_adapters): ModuleDict()
                                                   )
                                                 )
                                               )
                                             )
                                             (pooler): BertPooler(
                                               (dense): Linear(in_features=768, out_features=768, bias=True)
                                               (activation): Tanh()
                                             )
                                             (invertible_lang_adapters): ModuleDict()
                                           )
                                         )
                                         (audio_enc): AudioEncoder(
                                           (conv_layers): ModuleList(
                                             (0): Conv1d(96, 96, kernel_size=(128,), stride=(2,))
                                             (1): Conv1d(96, 96, kernel_size=(128,), stride=(2,))
                                             (2): AdaptiveAvgPool1d(output_size=200)
                                           )
                                         )
                                         (proj_poster): Linear(in_features=4096, out_features=768, bias=False)
                                         (proj2_poster): Linear(in_features=4096, out_features=768, bias=False)
                                         (proj_l_e): Linear(in_features=768, out_features=768, bias=False)
                                         (proj_v_e): Linear(in_features=4096, out_features=768, bias=False)
                                         (proj_a_e): Linear(in_features=96, out_features=768, bias=False)
                                         (proj_l): Conv1d(768, 768, kernel_size=(1,), stride=(1,), bias=False)
                                         (proj_v): Conv1d(4096, 768, kernel_size=(1,), stride=(1,), bias=False)
                                         (proj_a): Conv1d(96, 768, kernel_size=(1,), stride=(1,), bias=False)
                                         (trans_l_with_a): TransformerEncoder(
                                           (embed_positions): SinusoidalPositionalEmbedding()
                                           (layers): ModuleList(
                                             (0): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=768, out_features=768, bias=True)
                                               )
                                               (fc1): Linear(in_features=768, out_features=3072, bias=True)
                                               (fc2): Linear(in_features=3072, out_features=768, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                             (1): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=768, out_features=768, bias=True)
                                               )
                                               (fc1): Linear(in_features=768, out_features=3072, bias=True)
                                               (fc2): Linear(in_features=3072, out_features=768, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                             (2): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=768, out_features=768, bias=True)
                                               )
                                               (fc1): Linear(in_features=768, out_features=3072, bias=True)
                                               (fc2): Linear(in_features=3072, out_features=768, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                             (3): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=768, out_features=768, bias=True)
                                               )
                                               (fc1): Linear(in_features=768, out_features=3072, bias=True)
                                               (fc2): Linear(in_features=3072, out_features=768, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                             (4): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=768, out_features=768, bias=True)
                                               )
                                               (fc1): Linear(in_features=768, out_features=3072, bias=True)
                                               (fc2): Linear(in_features=3072, out_features=768, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                           )
                                           (layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                         )
                                         (trans_l_with_v): TransformerEncoder(
                                           (embed_positions): SinusoidalPositionalEmbedding()
                                           (layers): ModuleList(
                                             (0): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=768, out_features=768, bias=True)
                                               )
                                               (fc1): Linear(in_features=768, out_features=3072, bias=True)
                                               (fc2): Linear(in_features=3072, out_features=768, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                             (1): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=768, out_features=768, bias=True)
                                               )
                                               (fc1): Linear(in_features=768, out_features=3072, bias=True)
                                               (fc2): Linear(in_features=3072, out_features=768, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                             (2): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=768, out_features=768, bias=True)
                                               )
                                               (fc1): Linear(in_features=768, out_features=3072, bias=True)
                                               (fc2): Linear(in_features=3072, out_features=768, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                             (3): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=768, out_features=768, bias=True)
                                               )
                                               (fc1): Linear(in_features=768, out_features=3072, bias=True)
                                               (fc2): Linear(in_features=3072, out_features=768, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                             (4): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=768, out_features=768, bias=True)
                                               )
                                               (fc1): Linear(in_features=768, out_features=3072, bias=True)
                                               (fc2): Linear(in_features=3072, out_features=768, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                           )
                                           (layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                         )
                                         (trans_v_with_l): TransformerEncoder(
                                           (embed_positions): SinusoidalPositionalEmbedding()
                                           (layers): ModuleList(
                                             (0): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=768, out_features=768, bias=True)
                                               )
                                               (fc1): Linear(in_features=768, out_features=3072, bias=True)
                                               (fc2): Linear(in_features=3072, out_features=768, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                             (1): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=768, out_features=768, bias=True)
                                               )
                                               (fc1): Linear(in_features=768, out_features=3072, bias=True)
                                               (fc2): Linear(in_features=3072, out_features=768, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                             (2): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=768, out_features=768, bias=True)
                                               )
                                               (fc1): Linear(in_features=768, out_features=3072, bias=True)
                                               (fc2): Linear(in_features=3072, out_features=768, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                             (3): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=768, out_features=768, bias=True)
                                               )
                                               (fc1): Linear(in_features=768, out_features=3072, bias=True)
                                               (fc2): Linear(in_features=3072, out_features=768, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                             (4): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=768, out_features=768, bias=True)
                                               )
                                               (fc1): Linear(in_features=768, out_features=3072, bias=True)
                                               (fc2): Linear(in_features=3072, out_features=768, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                           )
                                           (layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                         )
                                         (trans_v_with_a): TransformerEncoder(
                                           (embed_positions): SinusoidalPositionalEmbedding()
                                           (layers): ModuleList(
                                             (0): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=768, out_features=768, bias=True)
                                               )
                                               (fc1): Linear(in_features=768, out_features=3072, bias=True)
                                               (fc2): Linear(in_features=3072, out_features=768, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                             (1): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=768, out_features=768, bias=True)
                                               )
                                               (fc1): Linear(in_features=768, out_features=3072, bias=True)
                                               (fc2): Linear(in_features=3072, out_features=768, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                             (2): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=768, out_features=768, bias=True)
                                               )
                                               (fc1): Linear(in_features=768, out_features=3072, bias=True)
                                               (fc2): Linear(in_features=3072, out_features=768, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                             (3): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=768, out_features=768, bias=True)
                                               )
                                               (fc1): Linear(in_features=768, out_features=3072, bias=True)
                                               (fc2): Linear(in_features=3072, out_features=768, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                             (4): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=768, out_features=768, bias=True)
                                               )
                                               (fc1): Linear(in_features=768, out_features=3072, bias=True)
                                               (fc2): Linear(in_features=3072, out_features=768, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                           )
                                           (layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                         )
                                         (trans_a_with_l): TransformerEncoder(
                                           (embed_positions): SinusoidalPositionalEmbedding()
                                           (layers): ModuleList(
                                             (0): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=768, out_features=768, bias=True)
                                               )
                                               (fc1): Linear(in_features=768, out_features=3072, bias=True)
                                               (fc2): Linear(in_features=3072, out_features=768, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                             (1): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=768, out_features=768, bias=True)
                                               )
                                               (fc1): Linear(in_features=768, out_features=3072, bias=True)
                                               (fc2): Linear(in_features=3072, out_features=768, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                             (2): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=768, out_features=768, bias=True)
                                               )
                                               (fc1): Linear(in_features=768, out_features=3072, bias=True)
                                               (fc2): Linear(in_features=3072, out_features=768, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                             (3): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=768, out_features=768, bias=True)
                                               )
                                               (fc1): Linear(in_features=768, out_features=3072, bias=True)
                                               (fc2): Linear(in_features=3072, out_features=768, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                             (4): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=768, out_features=768, bias=True)
                                               )
                                               (fc1): Linear(in_features=768, out_features=3072, bias=True)
                                               (fc2): Linear(in_features=3072, out_features=768, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                           )
                                           (layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                         )
                                         (trans_a_with_v): TransformerEncoder(
                                           (embed_positions): SinusoidalPositionalEmbedding()
                                           (layers): ModuleList(
                                             (0): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=768, out_features=768, bias=True)
                                               )
                                               (fc1): Linear(in_features=768, out_features=3072, bias=True)
                                               (fc2): Linear(in_features=3072, out_features=768, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                             (1): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=768, out_features=768, bias=True)
                                               )
                                               (fc1): Linear(in_features=768, out_features=3072, bias=True)
                                               (fc2): Linear(in_features=3072, out_features=768, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                             (2): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=768, out_features=768, bias=True)
                                               )
                                               (fc1): Linear(in_features=768, out_features=3072, bias=True)
                                               (fc2): Linear(in_features=3072, out_features=768, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                             (3): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=768, out_features=768, bias=True)
                                               )
                                               (fc1): Linear(in_features=768, out_features=3072, bias=True)
                                               (fc2): Linear(in_features=3072, out_features=768, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                             (4): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=768, out_features=768, bias=True)
                                               )
                                               (fc1): Linear(in_features=768, out_features=3072, bias=True)
                                               (fc2): Linear(in_features=3072, out_features=768, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                           )
                                           (layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                         )
                                         (trans_l_mem): TransformerEncoder(
                                           (embed_positions): SinusoidalPositionalEmbedding()
                                           (layers): ModuleList(
                                             (0): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=1536, out_features=1536, bias=True)
                                               )
                                               (fc1): Linear(in_features=1536, out_features=6144, bias=True)
                                               (fc2): Linear(in_features=6144, out_features=1536, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                             (1): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=1536, out_features=1536, bias=True)
                                               )
                                               (fc1): Linear(in_features=1536, out_features=6144, bias=True)
                                               (fc2): Linear(in_features=6144, out_features=1536, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                             (2): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=1536, out_features=1536, bias=True)
                                               )
                                               (fc1): Linear(in_features=1536, out_features=6144, bias=True)
                                               (fc2): Linear(in_features=6144, out_features=1536, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                             (3): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=1536, out_features=1536, bias=True)
                                               )
                                               (fc1): Linear(in_features=1536, out_features=6144, bias=True)
                                               (fc2): Linear(in_features=6144, out_features=1536, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                             (4): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=1536, out_features=1536, bias=True)
                                               )
                                               (fc1): Linear(in_features=1536, out_features=6144, bias=True)
                                               (fc2): Linear(in_features=6144, out_features=1536, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                           )
                                           (layer_norm): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
                                         )
                                         (trans_v_mem): TransformerEncoder(
                                           (embed_positions): SinusoidalPositionalEmbedding()
                                           (layers): ModuleList(
                                             (0): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=1536, out_features=1536, bias=True)
                                               )
                                               (fc1): Linear(in_features=1536, out_features=6144, bias=True)
                                               (fc2): Linear(in_features=6144, out_features=1536, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                             (1): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=1536, out_features=1536, bias=True)
                                               )
                                               (fc1): Linear(in_features=1536, out_features=6144, bias=True)
                                               (fc2): Linear(in_features=6144, out_features=1536, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                             (2): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=1536, out_features=1536, bias=True)
                                               )
                                               (fc1): Linear(in_features=1536, out_features=6144, bias=True)
                                               (fc2): Linear(in_features=6144, out_features=1536, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                             (3): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=1536, out_features=1536, bias=True)
                                               )
                                               (fc1): Linear(in_features=1536, out_features=6144, bias=True)
                                               (fc2): Linear(in_features=6144, out_features=1536, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                             (4): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=1536, out_features=1536, bias=True)
                                               )
                                               (fc1): Linear(in_features=1536, out_features=6144, bias=True)
                                               (fc2): Linear(in_features=6144, out_features=1536, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                           )
                                           (layer_norm): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
                                         )
                                         (trans_a_mem): TransformerEncoder(
                                           (embed_positions): SinusoidalPositionalEmbedding()
                                           (layers): ModuleList(
                                             (0): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=1536, out_features=1536, bias=True)
                                               )
                                               (fc1): Linear(in_features=1536, out_features=6144, bias=True)
                                               (fc2): Linear(in_features=6144, out_features=1536, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                             (1): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=1536, out_features=1536, bias=True)
                                               )
                                               (fc1): Linear(in_features=1536, out_features=6144, bias=True)
                                               (fc2): Linear(in_features=6144, out_features=1536, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                             (2): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=1536, out_features=1536, bias=True)
                                               )
                                               (fc1): Linear(in_features=1536, out_features=6144, bias=True)
                                               (fc2): Linear(in_features=6144, out_features=1536, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                             (3): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=1536, out_features=1536, bias=True)
                                               )
                                               (fc1): Linear(in_features=1536, out_features=6144, bias=True)
                                               (fc2): Linear(in_features=6144, out_features=1536, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                             (4): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=1536, out_features=1536, bias=True)
                                               )
                                               (fc1): Linear(in_features=1536, out_features=6144, bias=True)
                                               (fc2): Linear(in_features=6144, out_features=1536, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                           )
                                           (layer_norm): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
                                         )
                                         (proj1): Linear(in_features=768, out_features=768, bias=True)
                                         (proj2): Linear(in_features=768, out_features=768, bias=True)
                                         (out_layer): Linear(in_features=768, out_features=13, bias=True)
                                         (proj12): Linear(in_features=768, out_features=768, bias=True)
                                         (proj22): Linear(in_features=768, out_features=768, bias=True)
                                         (out_layer2): Linear(in_features=768, out_features=13, bias=True)
                                         (out_layer_final): Linear(in_features=13, out_features=13, bias=True)
                                         (gmu): TextShifting5Layer(
                                           (hidden1): Linear(in_features=1536, out_features=768, bias=False)
                                           (hidden2): Linear(in_features=1536, out_features=768, bias=False)
                                           (hidden3): Linear(in_features=1536, out_features=768, bias=False)
                                           (hidden4): Linear(in_features=768, out_features=768, bias=False)
                                           (hidden5): Linear(in_features=768, out_features=768, bias=False)
                                           (x1_gate): Linear(in_features=6144, out_features=768, bias=False)
                                           (x2_gate): Linear(in_features=6144, out_features=768, bias=False)
                                           (x3_gate): Linear(in_features=6144, out_features=768, bias=False)
                                           (x4_gate): Linear(in_features=6144, out_features=768, bias=False)
                                           (x5_gate): Linear(in_features=6144, out_features=768, bias=False)
                                         )
                                         (gmuSimple): TextShifting4LayerSimple(
                                           (hidden1): Linear(in_features=768, out_features=768, bias=False)
                                           (hidden2): Linear(in_features=768, out_features=768, bias=False)
                                           (hidden3): Linear(in_features=768, out_features=768, bias=False)
                                           (hidden4): Linear(in_features=768, out_features=768, bias=False)
                                           (x1_gate): Linear(in_features=768, out_features=768, bias=False)
                                           (x2_gate): Linear(in_features=768, out_features=768, bias=False)
                                           (x3_gate): Linear(in_features=768, out_features=768, bias=False)
                                           (x4_gate): Linear(in_features=768, out_features=768, bias=False)
                                         )
                                       )
                                     )
INFO - 09/07/21 23:30:38 - 0:00:01 - Training..
INFO - 09/07/21 23:38:44 - 0:00:00 - a_len: 3
                                     adapter_size: 64
                                     aonly: True
                                     attn_dropout: 0.1
                                     attn_dropout_a: 0.0
                                     attn_dropout_v: 0.0
                                     attn_mask: True
                                     batch_sz: 8
                                     bert_model: bert-base-uncased
                                     chunk_size: 100
                                     config_file: /home/est_posgrado_diego.moreno/vilbert-multi-task/config/bert_base_6layer_6conect.json
                                     data_path: /home/est_posgrado_diego.moreno/Workspace/Tesis/multimodal-transformers-movies/datasets
                                     drop_img_percent: 0.0
                                     dropout: 0.1
                                     embed_dropout: 0.25
                                     embed_sz: 300
                                     freeze_img: 0
                                     freeze_txt: 0
                                     from_pretrained: /home/est_posgrado_diego.moreno/vilbert-multi-task/save/multi_task_model.bin
                                     glove_path: /path/to/glove_embeds/glove.840B.300d.txt
                                     gradient_accumulation_steps: 16
                                     hidden: []
                                     hidden_sz: 768
                                     img_embed_pool_type: avg
                                     img_hidden_sz: 2048
                                     include_bn: True
                                     l_len: 512
                                     label_freqs: Counter({'Drama': 1803, 'Comedy': 1276, 'Thriller': 1010, 'Action': 825, 'Romance': 767, 'Fantasy': 665, 'Crime': 610, 'Sci-Fi': 424, 'Horror': 395, 'Family': 385, 'Mystery': 343, 'Biography': 207, 'Animation': 175})
                                     labels: ['Mystery', 'Thriller', 'Comedy', 'Action', 'Crime', 'Drama', 'Fantasy', 'Family', 'Horror', 'Biography', 'Romance', 'Sci-Fi', 'Animation']
                                     layers: 5
                                     lonly: True
                                     lr: 5e-05
                                     lr_factor: 0.5
                                     lr_patience: 2
                                     max_epochs: 100
                                     max_seq_len: 512
                                     model: mmtrvapt
                                     n_classes: 13
                                     n_workers: 12
                                     name: moviescope_Seed1_mmbt_model_run
                                     nlevels: 5
                                     num_heads: 6
                                     num_image_embeds: 3
                                     num_images: 8
                                     orig_d_a: 96
                                     orig_d_l: 768
                                     orig_d_m: 312
                                     orig_d_v: 4096
                                     out_dropout: 0.0
                                     output_gates: False
                                     patience: 5
                                     pooling: cls
                                     relu_dropout: 0.1
                                     res_dropout: 0.1
                                     savedir: /home/est_posgrado_diego.moreno/Workspace/Tesis/multimodal-transformers-movies/model_save_mmtr_hybrid_v4/moviescope_Seed1_mmbt_model_run
                                     seed: 1
                                     task: moviescope
                                     task_type: multilabel
                                     train_data_len: 3449
                                     train_type: split
                                     trained_model_dir: 
                                     v_len: 3
                                     vision_scratch: False
                                     visual: both
                                     vocab: <mmbt.data.vocab.Vocab object at 0x7f932f624f70>
                                     vocab_sz: 30522
                                     vonly: True
                                     warmup: 0.1
                                     weight_classes: 1
INFO - 09/07/21 23:38:44 - 0:00:00 - DataParallel(
                                       (module): MMTransformerGMUHybridClf(
                                         (enc): BertEncoder(
                                           (bert): BertModel(
                                             (embeddings): BertEmbeddings(
                                               (word_embeddings): Embedding(30522, 768, padding_idx=0)
                                               (position_embeddings): Embedding(512, 768)
                                               (token_type_embeddings): Embedding(2, 768)
                                               (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
                                               (dropout): Dropout(p=0.1, inplace=False)
                                             )
                                             (encoder): BertEncoder(
                                               (layer): ModuleList(
                                                 (0): BertLayer(
                                                   (attention): BertAttention(
                                                     (self): BertSelfAttention(
                                                       (query): Linear(in_features=768, out_features=768, bias=True)
                                                       (key): Linear(in_features=768, out_features=768, bias=True)
                                                       (value): Linear(in_features=768, out_features=768, bias=True)
                                                       (dropout): Dropout(p=0.1, inplace=False)
                                                     )
                                                     (output): BertSelfOutput(
                                                       (dense): Linear(in_features=768, out_features=768, bias=True)
                                                       (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
                                                       (dropout): Dropout(p=0.1, inplace=False)
                                                       (attention_text_task_adapters): ModuleDict()
                                                       (adapter_fusion_layer): ModuleDict()
                                                       (attention_text_lang_adapters): ModuleDict()
                                                     )
                                                   )
                                                   (intermediate): BertIntermediate(
                                                     (dense): Linear(in_features=768, out_features=3072, bias=True)
                                                   )
                                                   (output): BertOutput(
                                                     (dense): Linear(in_features=3072, out_features=768, bias=True)
                                                     (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
                                                     (dropout): Dropout(p=0.1, inplace=False)
                                                     (adapter_fusion_layer): ModuleDict()
                                                     (layer_text_task_adapters): ModuleDict()
                                                     (layer_text_lang_adapters): ModuleDict()
                                                   )
                                                 )
                                                 (1): BertLayer(
                                                   (attention): BertAttention(
                                                     (self): BertSelfAttention(
                                                       (query): Linear(in_features=768, out_features=768, bias=True)
                                                       (key): Linear(in_features=768, out_features=768, bias=True)
                                                       (value): Linear(in_features=768, out_features=768, bias=True)
                                                       (dropout): Dropout(p=0.1, inplace=False)
                                                     )
                                                     (output): BertSelfOutput(
                                                       (dense): Linear(in_features=768, out_features=768, bias=True)
                                                       (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
                                                       (dropout): Dropout(p=0.1, inplace=False)
                                                       (attention_text_task_adapters): ModuleDict()
                                                       (adapter_fusion_layer): ModuleDict()
                                                       (attention_text_lang_adapters): ModuleDict()
                                                     )
                                                   )
                                                   (intermediate): BertIntermediate(
                                                     (dense): Linear(in_features=768, out_features=3072, bias=True)
                                                   )
                                                   (output): BertOutput(
                                                     (dense): Linear(in_features=3072, out_features=768, bias=True)
                                                     (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
                                                     (dropout): Dropout(p=0.1, inplace=False)
                                                     (adapter_fusion_layer): ModuleDict()
                                                     (layer_text_task_adapters): ModuleDict()
                                                     (layer_text_lang_adapters): ModuleDict()
                                                   )
                                                 )
                                                 (2): BertLayer(
                                                   (attention): BertAttention(
                                                     (self): BertSelfAttention(
                                                       (query): Linear(in_features=768, out_features=768, bias=True)
                                                       (key): Linear(in_features=768, out_features=768, bias=True)
                                                       (value): Linear(in_features=768, out_features=768, bias=True)
                                                       (dropout): Dropout(p=0.1, inplace=False)
                                                     )
                                                     (output): BertSelfOutput(
                                                       (dense): Linear(in_features=768, out_features=768, bias=True)
                                                       (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
                                                       (dropout): Dropout(p=0.1, inplace=False)
                                                       (attention_text_task_adapters): ModuleDict()
                                                       (adapter_fusion_layer): ModuleDict()
                                                       (attention_text_lang_adapters): ModuleDict()
                                                     )
                                                   )
                                                   (intermediate): BertIntermediate(
                                                     (dense): Linear(in_features=768, out_features=3072, bias=True)
                                                   )
                                                   (output): BertOutput(
                                                     (dense): Linear(in_features=3072, out_features=768, bias=True)
                                                     (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
                                                     (dropout): Dropout(p=0.1, inplace=False)
                                                     (adapter_fusion_layer): ModuleDict()
                                                     (layer_text_task_adapters): ModuleDict()
                                                     (layer_text_lang_adapters): ModuleDict()
                                                   )
                                                 )
                                                 (3): BertLayer(
                                                   (attention): BertAttention(
                                                     (self): BertSelfAttention(
                                                       (query): Linear(in_features=768, out_features=768, bias=True)
                                                       (key): Linear(in_features=768, out_features=768, bias=True)
                                                       (value): Linear(in_features=768, out_features=768, bias=True)
                                                       (dropout): Dropout(p=0.1, inplace=False)
                                                     )
                                                     (output): BertSelfOutput(
                                                       (dense): Linear(in_features=768, out_features=768, bias=True)
                                                       (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
                                                       (dropout): Dropout(p=0.1, inplace=False)
                                                       (attention_text_task_adapters): ModuleDict()
                                                       (adapter_fusion_layer): ModuleDict()
                                                       (attention_text_lang_adapters): ModuleDict()
                                                     )
                                                   )
                                                   (intermediate): BertIntermediate(
                                                     (dense): Linear(in_features=768, out_features=3072, bias=True)
                                                   )
                                                   (output): BertOutput(
                                                     (dense): Linear(in_features=3072, out_features=768, bias=True)
                                                     (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
                                                     (dropout): Dropout(p=0.1, inplace=False)
                                                     (adapter_fusion_layer): ModuleDict()
                                                     (layer_text_task_adapters): ModuleDict()
                                                     (layer_text_lang_adapters): ModuleDict()
                                                   )
                                                 )
                                                 (4): BertLayer(
                                                   (attention): BertAttention(
                                                     (self): BertSelfAttention(
                                                       (query): Linear(in_features=768, out_features=768, bias=True)
                                                       (key): Linear(in_features=768, out_features=768, bias=True)
                                                       (value): Linear(in_features=768, out_features=768, bias=True)
                                                       (dropout): Dropout(p=0.1, inplace=False)
                                                     )
                                                     (output): BertSelfOutput(
                                                       (dense): Linear(in_features=768, out_features=768, bias=True)
                                                       (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
                                                       (dropout): Dropout(p=0.1, inplace=False)
                                                       (attention_text_task_adapters): ModuleDict()
                                                       (adapter_fusion_layer): ModuleDict()
                                                       (attention_text_lang_adapters): ModuleDict()
                                                     )
                                                   )
                                                   (intermediate): BertIntermediate(
                                                     (dense): Linear(in_features=768, out_features=3072, bias=True)
                                                   )
                                                   (output): BertOutput(
                                                     (dense): Linear(in_features=3072, out_features=768, bias=True)
                                                     (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
                                                     (dropout): Dropout(p=0.1, inplace=False)
                                                     (adapter_fusion_layer): ModuleDict()
                                                     (layer_text_task_adapters): ModuleDict()
                                                     (layer_text_lang_adapters): ModuleDict()
                                                   )
                                                 )
                                                 (5): BertLayer(
                                                   (attention): BertAttention(
                                                     (self): BertSelfAttention(
                                                       (query): Linear(in_features=768, out_features=768, bias=True)
                                                       (key): Linear(in_features=768, out_features=768, bias=True)
                                                       (value): Linear(in_features=768, out_features=768, bias=True)
                                                       (dropout): Dropout(p=0.1, inplace=False)
                                                     )
                                                     (output): BertSelfOutput(
                                                       (dense): Linear(in_features=768, out_features=768, bias=True)
                                                       (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
                                                       (dropout): Dropout(p=0.1, inplace=False)
                                                       (attention_text_task_adapters): ModuleDict()
                                                       (adapter_fusion_layer): ModuleDict()
                                                       (attention_text_lang_adapters): ModuleDict()
                                                     )
                                                   )
                                                   (intermediate): BertIntermediate(
                                                     (dense): Linear(in_features=768, out_features=3072, bias=True)
                                                   )
                                                   (output): BertOutput(
                                                     (dense): Linear(in_features=3072, out_features=768, bias=True)
                                                     (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
                                                     (dropout): Dropout(p=0.1, inplace=False)
                                                     (adapter_fusion_layer): ModuleDict()
                                                     (layer_text_task_adapters): ModuleDict()
                                                     (layer_text_lang_adapters): ModuleDict()
                                                   )
                                                 )
                                                 (6): BertLayer(
                                                   (attention): BertAttention(
                                                     (self): BertSelfAttention(
                                                       (query): Linear(in_features=768, out_features=768, bias=True)
                                                       (key): Linear(in_features=768, out_features=768, bias=True)
                                                       (value): Linear(in_features=768, out_features=768, bias=True)
                                                       (dropout): Dropout(p=0.1, inplace=False)
                                                     )
                                                     (output): BertSelfOutput(
                                                       (dense): Linear(in_features=768, out_features=768, bias=True)
                                                       (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
                                                       (dropout): Dropout(p=0.1, inplace=False)
                                                       (attention_text_task_adapters): ModuleDict()
                                                       (adapter_fusion_layer): ModuleDict()
                                                       (attention_text_lang_adapters): ModuleDict()
                                                     )
                                                   )
                                                   (intermediate): BertIntermediate(
                                                     (dense): Linear(in_features=768, out_features=3072, bias=True)
                                                   )
                                                   (output): BertOutput(
                                                     (dense): Linear(in_features=3072, out_features=768, bias=True)
                                                     (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
                                                     (dropout): Dropout(p=0.1, inplace=False)
                                                     (adapter_fusion_layer): ModuleDict()
                                                     (layer_text_task_adapters): ModuleDict()
                                                     (layer_text_lang_adapters): ModuleDict()
                                                   )
                                                 )
                                                 (7): BertLayer(
                                                   (attention): BertAttention(
                                                     (self): BertSelfAttention(
                                                       (query): Linear(in_features=768, out_features=768, bias=True)
                                                       (key): Linear(in_features=768, out_features=768, bias=True)
                                                       (value): Linear(in_features=768, out_features=768, bias=True)
                                                       (dropout): Dropout(p=0.1, inplace=False)
                                                     )
                                                     (output): BertSelfOutput(
                                                       (dense): Linear(in_features=768, out_features=768, bias=True)
                                                       (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
                                                       (dropout): Dropout(p=0.1, inplace=False)
                                                       (attention_text_task_adapters): ModuleDict()
                                                       (adapter_fusion_layer): ModuleDict()
                                                       (attention_text_lang_adapters): ModuleDict()
                                                     )
                                                   )
                                                   (intermediate): BertIntermediate(
                                                     (dense): Linear(in_features=768, out_features=3072, bias=True)
                                                   )
                                                   (output): BertOutput(
                                                     (dense): Linear(in_features=3072, out_features=768, bias=True)
                                                     (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
                                                     (dropout): Dropout(p=0.1, inplace=False)
                                                     (adapter_fusion_layer): ModuleDict()
                                                     (layer_text_task_adapters): ModuleDict()
                                                     (layer_text_lang_adapters): ModuleDict()
                                                   )
                                                 )
                                                 (8): BertLayer(
                                                   (attention): BertAttention(
                                                     (self): BertSelfAttention(
                                                       (query): Linear(in_features=768, out_features=768, bias=True)
                                                       (key): Linear(in_features=768, out_features=768, bias=True)
                                                       (value): Linear(in_features=768, out_features=768, bias=True)
                                                       (dropout): Dropout(p=0.1, inplace=False)
                                                     )
                                                     (output): BertSelfOutput(
                                                       (dense): Linear(in_features=768, out_features=768, bias=True)
                                                       (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
                                                       (dropout): Dropout(p=0.1, inplace=False)
                                                       (attention_text_task_adapters): ModuleDict()
                                                       (adapter_fusion_layer): ModuleDict()
                                                       (attention_text_lang_adapters): ModuleDict()
                                                     )
                                                   )
                                                   (intermediate): BertIntermediate(
                                                     (dense): Linear(in_features=768, out_features=3072, bias=True)
                                                   )
                                                   (output): BertOutput(
                                                     (dense): Linear(in_features=3072, out_features=768, bias=True)
                                                     (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
                                                     (dropout): Dropout(p=0.1, inplace=False)
                                                     (adapter_fusion_layer): ModuleDict()
                                                     (layer_text_task_adapters): ModuleDict()
                                                     (layer_text_lang_adapters): ModuleDict()
                                                   )
                                                 )
                                                 (9): BertLayer(
                                                   (attention): BertAttention(
                                                     (self): BertSelfAttention(
                                                       (query): Linear(in_features=768, out_features=768, bias=True)
                                                       (key): Linear(in_features=768, out_features=768, bias=True)
                                                       (value): Linear(in_features=768, out_features=768, bias=True)
                                                       (dropout): Dropout(p=0.1, inplace=False)
                                                     )
                                                     (output): BertSelfOutput(
                                                       (dense): Linear(in_features=768, out_features=768, bias=True)
                                                       (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
                                                       (dropout): Dropout(p=0.1, inplace=False)
                                                       (attention_text_task_adapters): ModuleDict()
                                                       (adapter_fusion_layer): ModuleDict()
                                                       (attention_text_lang_adapters): ModuleDict()
                                                     )
                                                   )
                                                   (intermediate): BertIntermediate(
                                                     (dense): Linear(in_features=768, out_features=3072, bias=True)
                                                   )
                                                   (output): BertOutput(
                                                     (dense): Linear(in_features=3072, out_features=768, bias=True)
                                                     (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
                                                     (dropout): Dropout(p=0.1, inplace=False)
                                                     (adapter_fusion_layer): ModuleDict()
                                                     (layer_text_task_adapters): ModuleDict()
                                                     (layer_text_lang_adapters): ModuleDict()
                                                   )
                                                 )
                                                 (10): BertLayer(
                                                   (attention): BertAttention(
                                                     (self): BertSelfAttention(
                                                       (query): Linear(in_features=768, out_features=768, bias=True)
                                                       (key): Linear(in_features=768, out_features=768, bias=True)
                                                       (value): Linear(in_features=768, out_features=768, bias=True)
                                                       (dropout): Dropout(p=0.1, inplace=False)
                                                     )
                                                     (output): BertSelfOutput(
                                                       (dense): Linear(in_features=768, out_features=768, bias=True)
                                                       (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
                                                       (dropout): Dropout(p=0.1, inplace=False)
                                                       (attention_text_task_adapters): ModuleDict()
                                                       (adapter_fusion_layer): ModuleDict()
                                                       (attention_text_lang_adapters): ModuleDict()
                                                     )
                                                   )
                                                   (intermediate): BertIntermediate(
                                                     (dense): Linear(in_features=768, out_features=3072, bias=True)
                                                   )
                                                   (output): BertOutput(
                                                     (dense): Linear(in_features=3072, out_features=768, bias=True)
                                                     (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
                                                     (dropout): Dropout(p=0.1, inplace=False)
                                                     (adapter_fusion_layer): ModuleDict()
                                                     (layer_text_task_adapters): ModuleDict()
                                                     (layer_text_lang_adapters): ModuleDict()
                                                   )
                                                 )
                                                 (11): BertLayer(
                                                   (attention): BertAttention(
                                                     (self): BertSelfAttention(
                                                       (query): Linear(in_features=768, out_features=768, bias=True)
                                                       (key): Linear(in_features=768, out_features=768, bias=True)
                                                       (value): Linear(in_features=768, out_features=768, bias=True)
                                                       (dropout): Dropout(p=0.1, inplace=False)
                                                     )
                                                     (output): BertSelfOutput(
                                                       (dense): Linear(in_features=768, out_features=768, bias=True)
                                                       (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
                                                       (dropout): Dropout(p=0.1, inplace=False)
                                                       (attention_text_task_adapters): ModuleDict()
                                                       (adapter_fusion_layer): ModuleDict()
                                                       (attention_text_lang_adapters): ModuleDict()
                                                     )
                                                   )
                                                   (intermediate): BertIntermediate(
                                                     (dense): Linear(in_features=768, out_features=3072, bias=True)
                                                   )
                                                   (output): BertOutput(
                                                     (dense): Linear(in_features=3072, out_features=768, bias=True)
                                                     (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
                                                     (dropout): Dropout(p=0.1, inplace=False)
                                                     (adapter_fusion_layer): ModuleDict()
                                                     (layer_text_task_adapters): ModuleDict()
                                                     (layer_text_lang_adapters): ModuleDict()
                                                   )
                                                 )
                                               )
                                             )
                                             (pooler): BertPooler(
                                               (dense): Linear(in_features=768, out_features=768, bias=True)
                                               (activation): Tanh()
                                             )
                                             (invertible_lang_adapters): ModuleDict()
                                           )
                                         )
                                         (audio_enc): AudioEncoder(
                                           (conv_layers): ModuleList(
                                             (0): Conv1d(96, 96, kernel_size=(128,), stride=(2,))
                                             (1): Conv1d(96, 96, kernel_size=(128,), stride=(2,))
                                             (2): AdaptiveAvgPool1d(output_size=200)
                                           )
                                         )
                                         (proj_poster): Linear(in_features=4096, out_features=768, bias=False)
                                         (proj2_poster): Linear(in_features=4096, out_features=768, bias=False)
                                         (proj_l_e): Linear(in_features=768, out_features=768, bias=False)
                                         (proj_v_e): Linear(in_features=4096, out_features=768, bias=False)
                                         (proj_a_e): Linear(in_features=96, out_features=768, bias=False)
                                         (proj_l): Conv1d(768, 768, kernel_size=(1,), stride=(1,), bias=False)
                                         (proj_v): Conv1d(4096, 768, kernel_size=(1,), stride=(1,), bias=False)
                                         (proj_a): Conv1d(96, 768, kernel_size=(1,), stride=(1,), bias=False)
                                         (trans_l_with_a): TransformerEncoder(
                                           (embed_positions): SinusoidalPositionalEmbedding()
                                           (layers): ModuleList(
                                             (0): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=768, out_features=768, bias=True)
                                               )
                                               (fc1): Linear(in_features=768, out_features=3072, bias=True)
                                               (fc2): Linear(in_features=3072, out_features=768, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                             (1): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=768, out_features=768, bias=True)
                                               )
                                               (fc1): Linear(in_features=768, out_features=3072, bias=True)
                                               (fc2): Linear(in_features=3072, out_features=768, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                             (2): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=768, out_features=768, bias=True)
                                               )
                                               (fc1): Linear(in_features=768, out_features=3072, bias=True)
                                               (fc2): Linear(in_features=3072, out_features=768, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                             (3): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=768, out_features=768, bias=True)
                                               )
                                               (fc1): Linear(in_features=768, out_features=3072, bias=True)
                                               (fc2): Linear(in_features=3072, out_features=768, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                             (4): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=768, out_features=768, bias=True)
                                               )
                                               (fc1): Linear(in_features=768, out_features=3072, bias=True)
                                               (fc2): Linear(in_features=3072, out_features=768, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                           )
                                           (layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                         )
                                         (trans_l_with_v): TransformerEncoder(
                                           (embed_positions): SinusoidalPositionalEmbedding()
                                           (layers): ModuleList(
                                             (0): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=768, out_features=768, bias=True)
                                               )
                                               (fc1): Linear(in_features=768, out_features=3072, bias=True)
                                               (fc2): Linear(in_features=3072, out_features=768, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                             (1): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=768, out_features=768, bias=True)
                                               )
                                               (fc1): Linear(in_features=768, out_features=3072, bias=True)
                                               (fc2): Linear(in_features=3072, out_features=768, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                             (2): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=768, out_features=768, bias=True)
                                               )
                                               (fc1): Linear(in_features=768, out_features=3072, bias=True)
                                               (fc2): Linear(in_features=3072, out_features=768, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                             (3): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=768, out_features=768, bias=True)
                                               )
                                               (fc1): Linear(in_features=768, out_features=3072, bias=True)
                                               (fc2): Linear(in_features=3072, out_features=768, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                             (4): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=768, out_features=768, bias=True)
                                               )
                                               (fc1): Linear(in_features=768, out_features=3072, bias=True)
                                               (fc2): Linear(in_features=3072, out_features=768, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                           )
                                           (layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                         )
                                         (trans_v_with_l): TransformerEncoder(
                                           (embed_positions): SinusoidalPositionalEmbedding()
                                           (layers): ModuleList(
                                             (0): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=768, out_features=768, bias=True)
                                               )
                                               (fc1): Linear(in_features=768, out_features=3072, bias=True)
                                               (fc2): Linear(in_features=3072, out_features=768, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                             (1): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=768, out_features=768, bias=True)
                                               )
                                               (fc1): Linear(in_features=768, out_features=3072, bias=True)
                                               (fc2): Linear(in_features=3072, out_features=768, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                             (2): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=768, out_features=768, bias=True)
                                               )
                                               (fc1): Linear(in_features=768, out_features=3072, bias=True)
                                               (fc2): Linear(in_features=3072, out_features=768, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                             (3): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=768, out_features=768, bias=True)
                                               )
                                               (fc1): Linear(in_features=768, out_features=3072, bias=True)
                                               (fc2): Linear(in_features=3072, out_features=768, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                             (4): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=768, out_features=768, bias=True)
                                               )
                                               (fc1): Linear(in_features=768, out_features=3072, bias=True)
                                               (fc2): Linear(in_features=3072, out_features=768, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                           )
                                           (layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                         )
                                         (trans_v_with_a): TransformerEncoder(
                                           (embed_positions): SinusoidalPositionalEmbedding()
                                           (layers): ModuleList(
                                             (0): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=768, out_features=768, bias=True)
                                               )
                                               (fc1): Linear(in_features=768, out_features=3072, bias=True)
                                               (fc2): Linear(in_features=3072, out_features=768, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                             (1): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=768, out_features=768, bias=True)
                                               )
                                               (fc1): Linear(in_features=768, out_features=3072, bias=True)
                                               (fc2): Linear(in_features=3072, out_features=768, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                             (2): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=768, out_features=768, bias=True)
                                               )
                                               (fc1): Linear(in_features=768, out_features=3072, bias=True)
                                               (fc2): Linear(in_features=3072, out_features=768, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                             (3): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=768, out_features=768, bias=True)
                                               )
                                               (fc1): Linear(in_features=768, out_features=3072, bias=True)
                                               (fc2): Linear(in_features=3072, out_features=768, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                             (4): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=768, out_features=768, bias=True)
                                               )
                                               (fc1): Linear(in_features=768, out_features=3072, bias=True)
                                               (fc2): Linear(in_features=3072, out_features=768, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                           )
                                           (layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                         )
                                         (trans_a_with_l): TransformerEncoder(
                                           (embed_positions): SinusoidalPositionalEmbedding()
                                           (layers): ModuleList(
                                             (0): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=768, out_features=768, bias=True)
                                               )
                                               (fc1): Linear(in_features=768, out_features=3072, bias=True)
                                               (fc2): Linear(in_features=3072, out_features=768, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                             (1): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=768, out_features=768, bias=True)
                                               )
                                               (fc1): Linear(in_features=768, out_features=3072, bias=True)
                                               (fc2): Linear(in_features=3072, out_features=768, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                             (2): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=768, out_features=768, bias=True)
                                               )
                                               (fc1): Linear(in_features=768, out_features=3072, bias=True)
                                               (fc2): Linear(in_features=3072, out_features=768, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                             (3): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=768, out_features=768, bias=True)
                                               )
                                               (fc1): Linear(in_features=768, out_features=3072, bias=True)
                                               (fc2): Linear(in_features=3072, out_features=768, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                             (4): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=768, out_features=768, bias=True)
                                               )
                                               (fc1): Linear(in_features=768, out_features=3072, bias=True)
                                               (fc2): Linear(in_features=3072, out_features=768, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                           )
                                           (layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                         )
                                         (trans_a_with_v): TransformerEncoder(
                                           (embed_positions): SinusoidalPositionalEmbedding()
                                           (layers): ModuleList(
                                             (0): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=768, out_features=768, bias=True)
                                               )
                                               (fc1): Linear(in_features=768, out_features=3072, bias=True)
                                               (fc2): Linear(in_features=3072, out_features=768, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                             (1): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=768, out_features=768, bias=True)
                                               )
                                               (fc1): Linear(in_features=768, out_features=3072, bias=True)
                                               (fc2): Linear(in_features=3072, out_features=768, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                             (2): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=768, out_features=768, bias=True)
                                               )
                                               (fc1): Linear(in_features=768, out_features=3072, bias=True)
                                               (fc2): Linear(in_features=3072, out_features=768, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                             (3): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=768, out_features=768, bias=True)
                                               )
                                               (fc1): Linear(in_features=768, out_features=3072, bias=True)
                                               (fc2): Linear(in_features=3072, out_features=768, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                             (4): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=768, out_features=768, bias=True)
                                               )
                                               (fc1): Linear(in_features=768, out_features=3072, bias=True)
                                               (fc2): Linear(in_features=3072, out_features=768, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                           )
                                           (layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                                         )
                                         (trans_l_mem): TransformerEncoder(
                                           (embed_positions): SinusoidalPositionalEmbedding()
                                           (layers): ModuleList(
                                             (0): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=1536, out_features=1536, bias=True)
                                               )
                                               (fc1): Linear(in_features=1536, out_features=6144, bias=True)
                                               (fc2): Linear(in_features=6144, out_features=1536, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                             (1): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=1536, out_features=1536, bias=True)
                                               )
                                               (fc1): Linear(in_features=1536, out_features=6144, bias=True)
                                               (fc2): Linear(in_features=6144, out_features=1536, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                             (2): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=1536, out_features=1536, bias=True)
                                               )
                                               (fc1): Linear(in_features=1536, out_features=6144, bias=True)
                                               (fc2): Linear(in_features=6144, out_features=1536, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                             (3): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=1536, out_features=1536, bias=True)
                                               )
                                               (fc1): Linear(in_features=1536, out_features=6144, bias=True)
                                               (fc2): Linear(in_features=6144, out_features=1536, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                             (4): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=1536, out_features=1536, bias=True)
                                               )
                                               (fc1): Linear(in_features=1536, out_features=6144, bias=True)
                                               (fc2): Linear(in_features=6144, out_features=1536, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                           )
                                           (layer_norm): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
                                         )
                                         (trans_v_mem): TransformerEncoder(
                                           (embed_positions): SinusoidalPositionalEmbedding()
                                           (layers): ModuleList(
                                             (0): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=1536, out_features=1536, bias=True)
                                               )
                                               (fc1): Linear(in_features=1536, out_features=6144, bias=True)
                                               (fc2): Linear(in_features=6144, out_features=1536, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                             (1): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=1536, out_features=1536, bias=True)
                                               )
                                               (fc1): Linear(in_features=1536, out_features=6144, bias=True)
                                               (fc2): Linear(in_features=6144, out_features=1536, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                             (2): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=1536, out_features=1536, bias=True)
                                               )
                                               (fc1): Linear(in_features=1536, out_features=6144, bias=True)
                                               (fc2): Linear(in_features=6144, out_features=1536, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                             (3): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=1536, out_features=1536, bias=True)
                                               )
                                               (fc1): Linear(in_features=1536, out_features=6144, bias=True)
                                               (fc2): Linear(in_features=6144, out_features=1536, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                             (4): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=1536, out_features=1536, bias=True)
                                               )
                                               (fc1): Linear(in_features=1536, out_features=6144, bias=True)
                                               (fc2): Linear(in_features=6144, out_features=1536, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                           )
                                           (layer_norm): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
                                         )
                                         (trans_a_mem): TransformerEncoder(
                                           (embed_positions): SinusoidalPositionalEmbedding()
                                           (layers): ModuleList(
                                             (0): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=1536, out_features=1536, bias=True)
                                               )
                                               (fc1): Linear(in_features=1536, out_features=6144, bias=True)
                                               (fc2): Linear(in_features=6144, out_features=1536, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                             (1): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=1536, out_features=1536, bias=True)
                                               )
                                               (fc1): Linear(in_features=1536, out_features=6144, bias=True)
                                               (fc2): Linear(in_features=6144, out_features=1536, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                             (2): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=1536, out_features=1536, bias=True)
                                               )
                                               (fc1): Linear(in_features=1536, out_features=6144, bias=True)
                                               (fc2): Linear(in_features=6144, out_features=1536, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                             (3): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=1536, out_features=1536, bias=True)
                                               )
                                               (fc1): Linear(in_features=1536, out_features=6144, bias=True)
                                               (fc2): Linear(in_features=6144, out_features=1536, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                             (4): TransformerEncoderLayer(
                                               (self_attn): MultiheadAttention(
                                                 (out_proj): Linear(in_features=1536, out_features=1536, bias=True)
                                               )
                                               (fc1): Linear(in_features=1536, out_features=6144, bias=True)
                                               (fc2): Linear(in_features=6144, out_features=1536, bias=True)
                                               (layer_norms): ModuleList(
                                                 (0): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
                                                 (1): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
                                               )
                                             )
                                           )
                                           (layer_norm): LayerNorm((1536,), eps=1e-05, elementwise_affine=True)
                                         )
                                         (proj1): Linear(in_features=768, out_features=768, bias=True)
                                         (proj2): Linear(in_features=768, out_features=768, bias=True)
                                         (out_layer): Linear(in_features=768, out_features=13, bias=True)
                                         (proj12): Linear(in_features=768, out_features=768, bias=True)
                                         (proj22): Linear(in_features=768, out_features=768, bias=True)
                                         (out_layer2): Linear(in_features=768, out_features=13, bias=True)
                                         (out_layer_final): Linear(in_features=13, out_features=13, bias=True)
                                         (gmu): TextShifting5Layer(
                                           (hidden1): Linear(in_features=1536, out_features=768, bias=False)
                                           (hidden2): Linear(in_features=1536, out_features=768, bias=False)
                                           (hidden3): Linear(in_features=1536, out_features=768, bias=False)
                                           (hidden4): Linear(in_features=768, out_features=768, bias=False)
                                           (hidden5): Linear(in_features=768, out_features=768, bias=False)
                                           (x1_gate): Linear(in_features=6144, out_features=768, bias=False)
                                           (x2_gate): Linear(in_features=6144, out_features=768, bias=False)
                                           (x3_gate): Linear(in_features=6144, out_features=768, bias=False)
                                           (x4_gate): Linear(in_features=6144, out_features=768, bias=False)
                                           (x5_gate): Linear(in_features=6144, out_features=768, bias=False)
                                         )
                                         (gmuSimple): TextShifting4LayerSimple(
                                           (hidden1): Linear(in_features=768, out_features=768, bias=False)
                                           (hidden2): Linear(in_features=768, out_features=768, bias=False)
                                           (hidden3): Linear(in_features=768, out_features=768, bias=False)
                                           (hidden4): Linear(in_features=768, out_features=768, bias=False)
                                           (x1_gate): Linear(in_features=768, out_features=768, bias=False)
                                           (x2_gate): Linear(in_features=768, out_features=768, bias=False)
                                           (x3_gate): Linear(in_features=768, out_features=768, bias=False)
                                           (x4_gate): Linear(in_features=768, out_features=768, bias=False)
                                         )
                                       )
                                     )
INFO - 09/07/21 23:38:45 - 0:00:01 - Training..
INFO - 09/07/21 23:56:14 - 0:17:30 - Train Loss: 0.0708
INFO - 09/07/21 23:56:14 - 0:17:30 - Val: Loss: 1.02378 | Macro F1 0.43225 | Micro F1: 0.45602 | AUC PR Macro: 0.45405 | AUC PR Micro: 0.48378
INFO - 09/08/21 00:18:51 - 0:40:07 - Train Loss: 0.0569
INFO - 09/08/21 00:18:51 - 0:40:07 - Val: Loss: 0.93228 | Macro F1 0.48641 | Micro F1: 0.52674 | AUC PR Macro: 0.53552 | AUC PR Micro: 0.55338
INFO - 09/08/21 00:39:16 - 1:00:32 - Train Loss: 0.0468
INFO - 09/08/21 00:39:16 - 1:00:32 - Val: Loss: 0.79437 | Macro F1 0.56415 | Micro F1: 0.60887 | AUC PR Macro: 0.62054 | AUC PR Micro: 0.64720
INFO - 09/08/21 00:59:47 - 1:21:03 - Train Loss: 0.0389
INFO - 09/08/21 00:59:47 - 1:21:03 - Val: Loss: 0.76961 | Macro F1 0.57369 | Micro F1: 0.61673 | AUC PR Macro: 0.66187 | AUC PR Micro: 0.67954
INFO - 09/08/21 01:19:54 - 1:41:11 - Train Loss: 0.0336
INFO - 09/08/21 01:19:54 - 1:41:11 - Val: Loss: 0.76888 | Macro F1 0.61918 | Micro F1: 0.64960 | AUC PR Macro: 0.68862 | AUC PR Micro: 0.70686
INFO - 09/08/21 01:40:15 - 2:01:31 - Train Loss: 0.0288
INFO - 09/08/21 01:40:15 - 2:01:31 - Val: Loss: 0.77561 | Macro F1 0.63134 | Micro F1: 0.66162 | AUC PR Macro: 0.70072 | AUC PR Micro: 0.73075
INFO - 09/08/21 02:00:36 - 2:21:52 - Train Loss: 0.0249
INFO - 09/08/21 02:00:36 - 2:21:52 - Val: Loss: 0.78377 | Macro F1 0.64189 | Micro F1: 0.67159 | AUC PR Macro: 0.70667 | AUC PR Micro: 0.72540
INFO - 09/08/21 02:16:55 - 2:38:11 - Train Loss: 0.0210
INFO - 09/08/21 02:16:55 - 2:38:11 - Val: Loss: 0.83194 | Macro F1 0.65976 | Micro F1: 0.68640 | AUC PR Macro: 0.71875 | AUC PR Micro: 0.73698
INFO - 09/08/21 02:36:25 - 2:57:41 - Train Loss: 0.0184
INFO - 09/08/21 02:36:25 - 2:57:41 - Val: Loss: 0.90778 | Macro F1 0.67168 | Micro F1: 0.69476 | AUC PR Macro: 0.71608 | AUC PR Micro: 0.74899
INFO - 09/08/21 02:56:15 - 3:17:31 - Train Loss: 0.0152
INFO - 09/08/21 02:56:15 - 3:17:31 - Val: Loss: 0.98462 | Macro F1 0.67476 | Micro F1: 0.69643 | AUC PR Macro: 0.72516 | AUC PR Micro: 0.76192
INFO - 09/08/21 03:15:38 - 3:36:54 - Train Loss: 0.0126
INFO - 09/08/21 03:15:38 - 3:36:54 - Val: Loss: 1.02597 | Macro F1 0.68912 | Micro F1: 0.71652 | AUC PR Macro: 0.72705 | AUC PR Micro: 0.77370
INFO - 09/08/21 03:34:44 - 3:56:01 - Train Loss: 0.0102
INFO - 09/08/21 03:34:44 - 3:56:01 - Val: Loss: 1.10178 | Macro F1 0.67523 | Micro F1: 0.70623 | AUC PR Macro: 0.73153 | AUC PR Micro: 0.77107
INFO - 09/08/21 03:51:35 - 4:12:51 - Train Loss: 0.0083
INFO - 09/08/21 03:51:35 - 4:12:51 - Val: Loss: 1.15315 | Macro F1 0.68972 | Micro F1: 0.71639 | AUC PR Macro: 0.72967 | AUC PR Micro: 0.77363
INFO - 09/08/21 04:08:15 - 4:29:31 - Train Loss: 0.0068
INFO - 09/08/21 04:08:15 - 4:29:31 - Val: Loss: 1.29598 | Macro F1 0.68785 | Micro F1: 0.71434 | AUC PR Macro: 0.73069 | AUC PR Micro: 0.77293
INFO - 09/08/21 04:25:02 - 4:46:18 - Train Loss: 0.0052
INFO - 09/08/21 04:25:02 - 4:46:18 - Val: Loss: 1.27174 | Macro F1 0.68146 | Micro F1: 0.71279 | AUC PR Macro: 0.73341 | AUC PR Micro: 0.77412
INFO - 09/08/21 04:43:51 - 5:05:07 - Train Loss: 0.0044
INFO - 09/08/21 04:43:51 - 5:05:07 - Val: Loss: 1.39097 | Macro F1 0.69266 | Micro F1: 0.72086 | AUC PR Macro: 0.73617 | AUC PR Micro: 0.77949
INFO - 09/08/21 05:04:22 - 5:25:38 - Train Loss: 0.0037
INFO - 09/08/21 05:04:22 - 5:25:38 - Val: Loss: 1.43905 | Macro F1 0.68083 | Micro F1: 0.70869 | AUC PR Macro: 0.73552 | AUC PR Micro: 0.77593
INFO - 09/08/21 05:21:51 - 5:43:07 - Train Loss: 0.0032
INFO - 09/08/21 05:21:51 - 5:43:07 - Val: Loss: 1.45420 | Macro F1 0.67052 | Micro F1: 0.70687 | AUC PR Macro: 0.72746 | AUC PR Micro: 0.76775
INFO - 09/08/21 05:38:43 - 5:59:59 - Train Loss: 0.0028
INFO - 09/08/21 05:38:43 - 5:59:59 - Val: Loss: 1.57167 | Macro F1 0.67451 | Micro F1: 0.71008 | AUC PR Macro: 0.73147 | AUC PR Micro: 0.77558
INFO - 09/08/21 05:56:00 - 6:17:17 - Train Loss: 0.0024
INFO - 09/08/21 05:56:00 - 6:17:17 - Val: Loss: 1.53970 | Macro F1 0.68616 | Micro F1: 0.71511 | AUC PR Macro: 0.73610 | AUC PR Micro: 0.77452
INFO - 09/08/21 06:13:22 - 6:34:38 - Train Loss: 0.0022
INFO - 09/08/21 06:13:22 - 6:34:38 - Val: Loss: 1.55193 | Macro F1 0.68593 | Micro F1: 0.71588 | AUC PR Macro: 0.73674 | AUC PR Micro: 0.77505
INFO - 09/08/21 06:15:43 - 6:36:59 - No improvement. Breaking out of loop.
INFO - 09/08/21 06:23:37 - 6:44:54 - Test - : Loss: 1.29438 | Macro F1 0.69381 | Micro F1: 0.71711 | AUC PR Macro: 0.74731 | AUC PR Micro: 0.78609
DEBUG - 09/08/21 06:23:38 - 6:44:54 - Starting new HTTPS connection (1): s3.amazonaws.com:443
INFO - 09/08/21 06:23:48 - 6:45:04 - loading vocabulary file https://s3.amazonaws.com/models.huggingface.co/bert/bert-base-uncased-vocab.txt from cache at /home/est_posgrado_diego.moreno/.pytorch_pretrained_bert/26bc1ad6c0ac742e9b52263248f6d0f00068293b33709fae12320c0e35ccfbbb.542ce4285a40d23a559526243235df47c5f75c197f04f37d1a0c124c32c9a084
DEBUG - 09/08/21 06:23:48 - 6:45:04 - Starting new HTTPS connection (1): s3.amazonaws.com:443
INFO - 09/08/21 06:23:58 - 6:45:14 - loading vocabulary file https://s3.amazonaws.com/models.huggingface.co/bert/bert-base-uncased-vocab.txt from cache at /home/est_posgrado_diego.moreno/.pytorch_pretrained_bert/26bc1ad6c0ac742e9b52263248f6d0f00068293b33709fae12320c0e35ccfbbb.542ce4285a40d23a559526243235df47c5f75c197f04f37d1a0c124c32c9a084
DEBUG - 09/08/21 06:23:58 - 6:45:14 - Starting new HTTPS connection (1): huggingface.co:443
DEBUG - 09/08/21 06:24:08 - 6:45:25 - Starting new HTTPS connection (1): huggingface.co:443
